{"version":3,"sources":["like.coffee"],"names":[],"mappings":"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","file":"like.js","sourceRoot":"/source/","sourcesContent":["###\n  Post likes via Ajax\n  requires: util.js\n###\n\n$ = jQuery\n\n\nclass Like\n\n  defaults:\n    csrfToken: \"csrf_token\",\n    likeText: \"like ({count})\",\n    removeLikeText: \"remove like ({count})\"\n\n  constructor: (el, options) ->\n    @el = $(el)\n    @options = $.extend {}, @defaults, options\n    @isSending = false\n    do @setUp\n\n  setUp: ->\n    @el.on 'click', @sendLike\n    @el.on 'click', @stopClick\n\n  sendLike: =>\n    if @isSending\n      return\n\n    @isSending = true\n\n    post = $.post @el.attr('href'), {csrfmiddlewaretoken: @options.csrfToken, }\n\n    post.done (data) =>\n      if data.url_delete\n        @addLike data\n      else if data.url_create\n        @removeLike data\n      else\n        do @apiError\n\n    post.always =>\n      @isSending = false\n\n    return\n\n  addLike: (data) =>\n    @el.attr 'href', data.url_delete\n    count = @el.data 'count'\n    count += 1\n    @el.data 'count', count\n    removeLikeText = $.format @options.removeLikeText, {count: count, }\n    @el.text removeLikeText\n\n  removeLike: (data) =>\n    @el.attr 'href', data.url_create\n    count = @el.data 'count'\n    count -= 1\n    @el.data 'count', count\n    likeText = $.format @options.likeText, {count: count, }\n    @el.text likeText\n\n  apiError: =>\n    @el.text \"api error\"\n\n  stopClick: (e) ->\n    do e.preventDefault\n    do e.stopPropagation\n    return\n\n\n$.fn.extend\n  like: (options) ->\n    @each ->\n      if not $(@).data 'plugin_like'\n        $(@).data 'plugin_like', new Like(@, options)\n\n$.fn.like.Like = Like"]}