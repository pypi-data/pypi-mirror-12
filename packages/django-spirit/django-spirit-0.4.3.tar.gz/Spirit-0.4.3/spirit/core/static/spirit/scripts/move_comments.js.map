{"version":3,"sources":["move_comments.coffee"],"names":[],"mappings":"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","file":"move_comments.js","sourceRoot":"/source/","sourcesContent":["###\n  Move comments to other topic\n###\n\n$ = jQuery\n\n\nclass MoveComment\n  #TODO: prefix classes with js-\n\n  defaults:\n    csrfToken: \"csrf_token\",\n    target: \"#post_url\"\n\n  constructor: (el, options) ->\n    @el = $(el)\n    @options = $.extend {}, @defaults, options\n    do @setUp\n\n  setUp: ->\n    @el.on 'click', @showMoveComments\n    @el.on 'click', @stopClick\n\n    # TODO: this should probably be moved from\n    # here to its own class, since it gets\n    # called for every el. Since we have only\n    # one \"move comments\" link, it's ok for now.\n    $move_comments = $(\".js-move-comments\")\n    $move_comments.on 'click', @moveComments\n    $move_comments.on 'click', @stopClick\n\n  showMoveComments: =>\n    if $(\".move-comments\").is \":hidden\"\n      do $(\".move-comments\").show\n      do @addCommentSelection\n\n    return\n\n  addCommentSelection: =>\n    $li = $(\"<li/>\").appendTo \".comment-date\"\n\n    $checkbox = $(\"<input/>\", {\n      class: \"move-comment-checkbox\",\n      name: \"comments\",\n      type: \"checkbox\",\n      value: \"\"\n    }).appendTo $li\n\n    # add comment_id to every checkbox value\n    $checkbox.each ->\n      $commentId = $(@).closest(\".comment\").data \"pk\"\n      $(@).val $commentId\n\n  moveComments: =>\n    $form = $(\"<form/>\", {\n      action: @options.target,\n      method: \"post\"\n    }).hide().appendTo $('body')\n\n    # inputCsrfToken\n    $(\"<input/>\", {\n      name: \"csrfmiddlewaretoken\",\n      type: \"hidden\",\n      value: @options.csrfToken\n    }).appendTo $form\n\n    # inputTopicId\n    topicId = $(\"#id_move_comments_topic\").val()\n    $(\"<input/>\", {\n      name: \"topic\",\n      type: \"text\",\n      value: topicId\n    }).appendTo $form\n\n    # append all selection inputs\n    $(\".move-comment-checkbox\").clone().appendTo $form\n\n    @formSubmit $form\n\n    return\n\n  formSubmit: ($form) ->\n    do $form.submit\n\n  stopClick: (e) ->\n    do e.preventDefault\n    do e.stopPropagation\n    return\n\n\n$.fn.extend\n  move_comments: (options) ->\n    @each ->\n      if not $(@).data 'plugin_move_comments'\n        $(@).data 'plugin_move_comments', new MoveComment(@, options)\n\n$.fn.move_comments.MoveComment = MoveComment"]}