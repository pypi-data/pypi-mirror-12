{"version":3,"sources":["move_comments.coffee"],"names":[],"mappings":"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","file":"move_comments.js","sourceRoot":"/source/","sourcesContent":["###\n    Move comments to other topic\n###\n\n$ = jQuery\n\n\nclass MoveComment\n    #TODO: prefix classes with js-\n\n    defaults: {\n        csrfToken: \"csrf_token\",\n        target: \"#post_url\"\n    }\n\n    constructor: (el, options) ->\n        @el = $(el)\n        @options = $.extend({}, @defaults, options)\n        @setUp()\n\n    setUp: ->\n        @el.on('click', @showMoveComments)\n        @el.on('click', @stopClick)\n\n        # TODO: this should probably be moved from\n        # here to its own class, since it gets\n        # called for every el. Since we have only\n        # one \"move comments\" link, it's ok for now.\n        $move_comments = $(\".js-move-comments\")\n        $move_comments.on('click', @moveComments)\n        $move_comments.on('click', @stopClick)\n\n    showMoveComments: =>\n        if $(\".move-comments\").is(\":hidden\")\n            $(\".move-comments\").show()\n            @addCommentSelection()\n\n        return\n\n    addCommentSelection: =>\n        $li = $(\"<li/>\").appendTo(\".comment-date\")\n\n        $checkbox = $(\"<input/>\", {\n            class: \"move-comment-checkbox\",\n            name: \"comments\",\n            type: \"checkbox\",\n            value: \"\"\n        }).appendTo($li)\n\n        # add comment_id to every checkbox value\n        $checkbox.each( ->\n            $commentId = $(@)\n                .closest(\".comment\")\n                .data(\"pk\")\n\n            $(@).val($commentId)\n        )\n\n    moveComments: =>\n        $form = $(\"<form/>\", {\n            action: @options.target,\n            method: \"post\"\n        }).hide()\n          .appendTo($('body'))\n\n        # inputCsrfToken\n        $(\"<input/>\", {\n            name: \"csrfmiddlewaretoken\",\n            type: \"hidden\",\n            value: @options.csrfToken\n        }).appendTo($form)\n\n        # inputTopicId\n        topicId = $(\"#id_move_comments_topic\").val()\n        $(\"<input/>\", {\n            name: \"topic\",\n            type: \"text\",\n            value: topicId\n        }).appendTo($form)\n\n        # append all selection inputs\n        $(\".move-comment-checkbox\")\n            .clone()\n            .appendTo($form)\n\n        @formSubmit($form)\n\n        return\n\n    formSubmit: ($form) ->\n        $form.submit()\n\n    stopClick: (e) ->\n        e.preventDefault()\n        e.stopPropagation()\n        return\n\n\n$.fn.extend\n    move_comments: (options) ->\n        @each( ->\n            if not $(@).data('plugin_move_comments')\n                $(@).data('plugin_move_comments', new MoveComment(@, options))\n        )\n\n$.fn.move_comments.MoveComment = MoveComment\n"]}