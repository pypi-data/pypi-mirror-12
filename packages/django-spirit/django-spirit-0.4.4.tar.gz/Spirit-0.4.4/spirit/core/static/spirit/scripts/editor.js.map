{"version":3,"sources":["editor.coffee"],"names":[],"mappings":"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","file":"editor.js","sourceRoot":"/source/","sourcesContent":["###\n    Markdown editor\n    requires: marked.js\n###\n\n$ = jQuery\n\n\nclass Editor\n\n    defaults: {\n        boldedText: \"bolded text\",\n        italicisedText: \"italicised text\",\n        listItemText: \"list item\",\n        linkText: \"link text\",\n        linkUrlText: \"link url\",\n        imageText: \"image text\",\n        imageUrlText: \"image url\",\n        pollTitleText: \"Title\",\n        pollChoiceText: \"Description\"\n    }\n\n    constructor: (el, options) ->\n        @el = $(el)\n        @options = $.extend({}, @defaults, options)\n        @pollCounter = 1\n        @setUp()\n\n    setUp: ->\n        # TODO: fixme, having multiple editor\n        # in the same page will trigger button\n        # click on every editor\n        $('.js-box-bold').on('click', @addBold)\n        $('.js-box-italic').on('click', @addItalic)\n        $('.js-box-list').on('click', @addList)\n        $('.js-box-url').on('click', @addUrl)\n        $('.js-box-image').on('click', @addImage)\n        $('.js-box-poll').on('click', @addPoll)\n        $('.js-box-preview').on('click', @togglePreview)\n\n    wrapSelection: (preTxt, postTxt, defaultTxt) =>\n        preSelection = @el\n            .val()\n            .substring(0, @el[0].selectionStart)\n        selection = @el\n            .val()\n            .substring(@el[0].selectionStart, @el[0].selectionEnd)\n        postSelection = @el\n            .val()\n            .substring(@el[0].selectionEnd)\n\n        if not selection\n            selection = defaultTxt\n\n        @el.val(preSelection + preTxt + selection + postTxt + postSelection)\n\n    addBold: =>\n        @wrapSelection(\"**\", \"**\", @options.boldedText)\n        return false\n\n    addItalic: =>\n        @wrapSelection(\"*\", \"*\", @options.italicisedText)\n        return false\n\n    addList: =>\n        @wrapSelection(\"\\n* \", \"\", @options.listItemText)\n        return false\n\n    addUrl: =>\n        @wrapSelection(\"[\", \"](#{ @options.linkUrlText })\", @options.linkText)\n        return false\n\n    addImage: =>\n        @wrapSelection(\"![\", \"](#{ @options.imageUrlText })\", @options.imageText)\n        return false\n\n    addPoll: =>\n        poll = \"\\n\\n[poll name=#{@pollCounter}]\\n\" +\n            \"# #{@options.pollTitleText}\\n\" +\n            \"1. #{@options.pollChoiceText}\\n\" +\n            \"2. #{@options.pollChoiceText}\\n\" +\n            \"[/poll]\\n\"\n        @wrapSelection(\"\", poll, \"\")  # todo: append to current pointer position\n        @pollCounter++\n        return false\n\n    togglePreview: =>\n        $preview = $('.js-box-preview-content')\n\n        @el.toggle()\n        $preview.toggle()\n        $preview.html(marked(@el.val()))\n\n        return false\n\n\n$.fn.extend\n    editor: (options) ->\n        @each( ->\n            if not $(@).data('plugin_editor')\n                $(@).data('plugin_editor', new Editor(@, options))\n        )\n\n$.fn.editor.Editor = Editor\n"]}