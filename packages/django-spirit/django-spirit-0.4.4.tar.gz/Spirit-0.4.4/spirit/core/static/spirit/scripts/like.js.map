{"version":3,"sources":["like.coffee"],"names":[],"mappings":"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","file":"like.js","sourceRoot":"/source/","sourcesContent":["###\n    Post likes via Ajax\n    requires: util.js\n###\n\n$ = jQuery\n\n\nclass Like\n\n    defaults: {\n        csrfToken: \"csrf_token\",\n        likeText: \"like ({count})\",\n        removeLikeText: \"remove like ({count})\"\n    }\n\n    constructor: (el, options) ->\n        @el = $(el)\n        @options = $.extend({}, @defaults, options)\n        @isSending = false\n        @setUp()\n\n    setUp: ->\n        @el.on('click', @sendLike)\n        @el.on('click', @stopClick)\n\n    sendLike: =>\n        if @isSending\n            return\n\n        @isSending = true\n\n        post = $.post(@el.attr('href'), {csrfmiddlewaretoken: @options.csrfToken})\n\n        post.done((data) =>\n            if data.url_delete\n                @addLike(data)\n            else if data.url_create\n                @removeLike(data)\n            else\n                @apiError()\n        )\n\n        post.always( =>\n            @isSending = false\n        )\n\n        return\n\n    addLike: (data) =>\n        @el.attr('href', data.url_delete)\n        count = @el.data('count')\n        count += 1\n        @el.data('count', count)\n        removeLikeText = $.format(@options.removeLikeText, {count: count})\n        @el.text(removeLikeText)\n\n    removeLike: (data) =>\n        @el.attr('href', data.url_create)\n        count = @el.data('count')\n        count -= 1\n        @el.data('count', count)\n        likeText = $.format(@options.likeText, {count: count})\n        @el.text(likeText)\n\n    apiError: =>\n        @el.text(\"api error\")\n\n    stopClick: (e) ->\n        e.preventDefault()\n        e.stopPropagation()\n        return\n\n\n$.fn.extend\n    like: (options) ->\n        @each( ->\n            if not $(@).data('plugin_like')\n                $(@).data('plugin_like', new Like(@, options))\n        )\n\n$.fn.like.Like = Like\n"]}