statechart:
  name: Doors are closed while moving
  initial: check_doors
  states:
    - name: check_doors  # Check if the doors are initially opened or not
      transitions:
        - target: opened
          guard: not step.context['doors'].opened
        - target: closed
          guard: step.context['doors'].opened
    - name: opened
      transitions:
        - target: closed
          event: step
          guard: not step.context['doors'].opened
        - target: error  # If we are moving and the doors are opened, error!
          event: step
          guard: step.active('moving')
    - name: closed
      transitions:
        - target: opened
          event: step
          guard: step.context['doors'].opened
    - name: error
      on entry: assert False, 'doors not closed and elevator is moving'

