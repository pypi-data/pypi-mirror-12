{% extends "bootstrap/base.html" %}
{% import "bootstrap/fixes.html" as fixes %}

{% block title %}
Libreant | {{ volume['metadata']['title'] if 'title' in volume['metadata'] else volume['id'] }}
{% endblock %}

{% block navbar %}
{% import 'navbar.html' as navbar %}
{{navbar.navbar()}}
{% endblock %}

{% block content %}

<div class="container">
    <header class="page-header" style="margin-top:0px">
	    <h1>{{ volume['metadata']['title'] if 'title' in volume['metadata'] else volume['id'] }}
		    <small>{{ volume['metadata']['actors'] | sort | join(',') }}</small>
	    </h1>
    </header>
     {% if (volume['attachments'] | length) > 0 %}
        {% for attachment in volume['attachments'] %}
             <a class="btn btn-default" href="{{ url_for('download_attachment', volumeID=volume['id'], attachmentID=attachment['id']) }}">
                <div class="row" style="display: flex; align-items: center;">
                    <div class="col-xs-1">
                        <span class="glyphicon glyphicon glyphicon-download-alt" aria-hidden="true"></span>
                    </div>
                    <div class="col-xs-11">
                        <strong>{{ attachment['metadata']['name'] }}</strong>
                        <p style="margin-bottom: 0px">{{ attachment['metadata']['size'] | filesizeformat() }}</p>
                    </div>
                </div>
             </a>
        {% endfor %}
    <br>
    <br>
    {% endif %}
    
    <article>
        <h4>{%trans%}Details{%endtrans%}</h4>
        <table class="table table-striped">
	        <thead>
		        <tr>
			        <th>{%trans%}Field{%endtrans%}</th>
			        <th>{%trans%}Value{%endtrans%}</th>
		        </tr>
	        </thead>
	        <tbody>
	        {% for key in volume['metadata'] %}
                {% if not key.startswith('_') %}
	            <tr>
		            <td>{{ key }}</td>
		            <td>{{ volume['metadata'][key] }}</td>
	            </tr>
                {% endif %}
	        {% endfor %}
	        </tbody>
        </table>
        <br>
        <br>
        {% if similar %}
        <h3>{%trans%}Similar books{%endtrans%}</h3>
        <table class="table table-striped"> <!-- definitely should not be formatted like this! -->
	        <tbody>
		        {% for book in similar %}
		        <tr>
			        <td><a href="{{url_for('view_volume',
			        volumeID=book['_id'])}}">
			        {{ book['_source']['title'] }}
				        </a></td>
			        <td>{{ book['_source']['actors'] | join(',') }}</td>
		        </tr>
		        {% endfor %}
	        </tbody>
        </table>
        {% endif %}
    </article>
<div class="container">
{% endblock content %}
