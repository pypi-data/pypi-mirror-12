

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MDAnalysis &mdash; MDAnalysis 0.11.0-dev documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.11.0-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.11.0-dev documentation"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.11.0-dev documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">MDAnalysis 0.11.0-dev documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for MDAnalysis</h1><div class="highlight"><pre>
<span class="c"># -*- Mode: python; tab-width: 4; indent-tabs-mode:nil; coding:utf-8 -*-</span>
<span class="c"># vim: tabstop=4 expandtab shiftwidth=4 softtabstop=4 fileencoding=utf-8</span>
<span class="c">#</span>
<span class="c"># MDAnalysis --- http://www.MDAnalysis.org</span>
<span class="c"># Copyright (c) 2006-2015 Naveen Michaud-Agrawal, Elizabeth J. Denning, Oliver Beckstein</span>
<span class="c"># and contributors (see AUTHORS for the full list)</span>
<span class="c">#</span>
<span class="c"># Released under the GNU Public Licence, v2 or any higher version</span>
<span class="c">#</span>
<span class="c"># Please cite your use of MDAnalysis in published work:</span>
<span class="c"># N. Michaud-Agrawal, E. J. Denning, T. B. Woolf, and O. Beckstein.</span>
<span class="c"># MDAnalysis: A Toolkit for the Analysis of Molecular Dynamics Simulations.</span>
<span class="c"># J. Comput. Chem. 32 (2011), 2319--2327, doi:10.1002/jcc.21787</span>
<span class="c">#</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">:mod:`MDAnalysis` --- analysis of molecular simulations in python</span>
<span class="sd">=================================================================</span>

<span class="sd">MDAnalysis (http://www.mdanalysis.org) is a python toolkit to analyze</span>
<span class="sd">molecular dynamics trajectories generated by CHARMM, NAMD, Amber,</span>
<span class="sd">Gromacs, or LAMMPS.</span>

<span class="sd">It allows one to read molecular dynamics trajectories and access the</span>
<span class="sd">atomic coordinates through numpy arrays. This provides a flexible and</span>
<span class="sd">relatively fast framework for complex analysis tasks. In addition,</span>
<span class="sd">CHARMM-style atom selection commands are implemented. Trajectories can</span>
<span class="sd">also be manipulated (for instance, fit to a reference structure) and</span>
<span class="sd">written out. Time-critical code is written in C for speed.</span>

<span class="sd">Help is also available through the mailinglist at</span>
<span class="sd">http://groups.google.com/group/mdnalysis-discussion</span>

<span class="sd">Please report bugs and feature requests through the issue tracker at</span>
<span class="sd">http://issues.mdanalysis.org</span>

<span class="sd">Citation</span>
<span class="sd">--------</span>

<span class="sd">When using MDAnalysis in published work, please cite</span>

<span class="sd">    N. Michaud-Agrawal, E. J. Denning, T. B. Woolf, and</span>
<span class="sd">    O. Beckstein. MDAnalysis: A Toolkit for the Analysis of Molecular Dynamics</span>
<span class="sd">    Simulations. J. Comput. Chem. 32 (2011), 2319--2327, doi:`10.1002/jcc.21787`_</span>
<span class="sd">    http://www.mdanalysis.org</span>

<span class="sd">For citations of included algorithms and sub-modules please see the references_.</span>

<span class="sd">.. _`10.1002/jcc.21787`: http://dx.doi.org/10.1002/jcc.21787</span>
<span class="sd">.. _references: http://docs.mdanalysis.org/documentation_pages/references.html</span>


<span class="sd">Getting started</span>
<span class="sd">---------------</span>

<span class="sd">Import the package::</span>

<span class="sd">  &gt;&gt;&gt; import MDAnalysis</span>

<span class="sd">(note that not everything in MDAnalysis is imported right away; for</span>
<span class="sd">additional functionality you might have to import sub-modules</span>
<span class="sd">separately, e.g. for RMS fitting ``import MDAnalysis.analysis.align``.)</span>

<span class="sd">Build a &quot;universe&quot; from a topology (PSF, PDB) and a trajectory (DCD, XTC/TRR);</span>
<span class="sd">here we are assuming that PSF, DCD, etc contain file names. If you don&#39;t have</span>
<span class="sd">trajectories at hand you can play with the ones that come with MDAnalysis for</span>
<span class="sd">testing (see below under `Examples`_)::</span>

<span class="sd">  &gt;&gt;&gt; u = MDAnalysis.Universe(PSF, DCD)</span>

<span class="sd">Select the C-alpha atoms and store them as a group of atoms::</span>

<span class="sd">  &gt;&gt;&gt; ca = u.select_atoms(&#39;name CA&#39;)</span>
<span class="sd">  &gt;&gt;&gt; len(ca)</span>
<span class="sd">  214</span>

<span class="sd">Calculate the centre of mass of the CA and of all atoms::</span>

<span class="sd">  &gt;&gt;&gt; ca.centerOfMass()</span>
<span class="sd">  array([ 0.06873595, -0.04605918, -0.24643682])</span>
<span class="sd">  &gt;&gt;&gt; u.atoms.centerOfMass()</span>
<span class="sd">  array([-0.01094035,  0.05727601, -0.12885778])</span>

<span class="sd">Calculate the CA end-to-end distance (in angstroem)::</span>
<span class="sd">  &gt;&gt;&gt; from numpy import sqrt, dot</span>
<span class="sd">  &gt;&gt;&gt; coord = ca.coordinates()</span>
<span class="sd">  &gt;&gt;&gt; v = coord[-1] - coord[0]   # last Ca minus first one</span>
<span class="sd">  &gt;&gt;&gt; sqrt(dot(v, v,))</span>
<span class="sd">  10.938133</span>

<span class="sd">Define a function eedist():</span>
<span class="sd">  &gt;&gt;&gt; def eedist(atoms):</span>
<span class="sd">  ...     coord = atoms.coordinates()</span>
<span class="sd">  ...     v = coord[-1] - coord[0]</span>
<span class="sd">  ...     return sqrt(dot(v, v,))</span>
<span class="sd">  ...</span>
<span class="sd">  &gt;&gt;&gt; eedist(ca)</span>
<span class="sd">  10.938133</span>

<span class="sd">and analyze all timesteps *ts* of the trajectory::</span>
<span class="sd">  &gt;&gt;&gt; for ts in u.trajectory:</span>
<span class="sd">  ...      print eedist(ca)</span>
<span class="sd">  10.9381</span>
<span class="sd">  10.8459</span>
<span class="sd">  10.4141</span>
<span class="sd">   9.72062</span>
<span class="sd">  ....</span>

<span class="sd">.. SeeAlso:: :class:`MDAnalysis.core.AtomGroup.Universe` for details</span>


<span class="sd">Examples</span>
<span class="sd">--------</span>

<span class="sd">MDAnalysis comes with a number of real trajectories for testing. You</span>
<span class="sd">can also use them to explore the functionality and ensure that</span>
<span class="sd">everything is working properly::</span>

<span class="sd">  from MDAnalysis import *</span>
<span class="sd">  from MDAnalysis.tests.datafiles import PSF,DCD, PDB,XTC</span>
<span class="sd">  u_dims_adk = Universe(PSF,DCD)</span>
<span class="sd">  u_eq_adk = Universe(PDB, XTC)</span>

<span class="sd">The PSF and DCD file are a closed-form-to-open-form transition of</span>
<span class="sd">Adenylate Kinase (from [Beckstein2009]_) and the PDB+XTC file are ten</span>
<span class="sd">frames from a Gromacs simulation of AdK solvated in TIP4P water with</span>
<span class="sd">the OPLS/AA force field.</span>

<span class="sd">.. [Beckstein2009] O. Beckstein, E.J. Denning, J.R. Perilla and T.B. Woolf,</span>
<span class="sd">   Zipping and Unzipping of Adenylate Kinase: Atomistic Insights into the</span>
<span class="sd">   Ensemble of Open &lt;--&gt; Closed Transitions. J Mol Biol 394 (2009), 160--176,</span>
<span class="sd">   doi:10.1016/j.jmb.2009.09.009</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Timeseries&#39;</span><span class="p">,</span> <span class="s">&#39;Universe&#39;</span><span class="p">,</span> <span class="s">&#39;asUniverse&#39;</span><span class="p">,</span> <span class="s">&#39;Writer&#39;</span><span class="p">,</span> <span class="s">&#39;collection&#39;</span><span class="p">]</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">.version</span> <span class="kn">import</span> <span class="n">__version__</span>

<span class="kn">from</span> <span class="nn">.lib</span> <span class="kn">import</span> <span class="n">log</span>
<span class="kn">from</span> <span class="nn">.lib.log</span> <span class="kn">import</span> <span class="n">start_logging</span><span class="p">,</span> <span class="n">stop_logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;MDAnalysis&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">NullHandler</span><span class="p">())</span>
<span class="k">del</span> <span class="n">logging</span>

<span class="c"># DeprecationWarnings are loud by default</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s">&#39;always&#39;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>

<span class="c"># custom exceptions and warnings</span>
<span class="kn">from</span> <span class="nn">.exceptions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SelectionError</span><span class="p">,</span> <span class="n">FinishTimeException</span><span class="p">,</span> <span class="n">NoDataError</span><span class="p">,</span> <span class="n">ApplicationError</span><span class="p">,</span>
    <span class="n">SelectionWarning</span><span class="p">,</span> <span class="n">MissingDataWarning</span><span class="p">,</span> <span class="n">ConversionWarning</span><span class="p">,</span> <span class="n">FileFormatWarning</span><span class="p">,</span>
    <span class="n">StreamWarning</span>
<span class="p">)</span>


<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">units</span>

<span class="c"># Bring some often used objects into the current namespace</span>
<span class="kn">from</span> <span class="nn">.core</span> <span class="kn">import</span> <span class="n">Timeseries</span>
<span class="kn">from</span> <span class="nn">.core.AtomGroup</span> <span class="kn">import</span> <span class="n">Universe</span><span class="p">,</span> <span class="n">asUniverse</span><span class="p">,</span> <span class="n">Merge</span>
<span class="kn">from</span> <span class="nn">.coordinates.core</span> <span class="kn">import</span> <span class="n">writer</span> <span class="k">as</span> <span class="n">Writer</span>

<span class="n">collection</span> <span class="o">=</span> <span class="n">Timeseries</span><span class="o">.</span><span class="n">TimeseriesCollection</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">weakref</span>
<span class="n">_anchor_universes</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakSet</span><span class="p">()</span>
<span class="n">_named_anchor_universes</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">WeakSet</span><span class="p">()</span>
<span class="k">del</span> <span class="n">weakref</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">MDAnalysis 0.11.0-dev documentation</a> &raquo;</li>
          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Joshua Adelman,
    Christian Beckstein (logo), Alejandro Bernardin, Sébastien Buchoux,
    David Caplan, Matthieu Chavent, Xavier Deupi, Jan Domański, David L. Dotson
    Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar,
    Benjamin Hall, Joe Jordan, Jinju Lu, Robert McGibbon, Alex Nesterenko,
    Manuel Nuno Melo, Caio S. Souza, Danny Parton, Joshua L. Phillips, Tyler Reddy,
    Paul Rigor, Sean L. Seyler, Andy Somogyi, Lukas Stelzl, Gorman Stock, Isaac Virshup,
    Zhuyi Xue, Carlos Yáñez S.,
    and Oliver Beckstein.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>