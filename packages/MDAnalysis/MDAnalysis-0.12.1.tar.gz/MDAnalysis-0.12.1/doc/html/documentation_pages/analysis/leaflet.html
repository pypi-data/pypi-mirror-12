<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.3.2. Leaflet identification — MDAnalysis.analysis.leaflet &mdash; MDAnalysis 0.12.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.12.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.12.1 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.12.1 documentation" href="../../index.html" />
    <link rel="up" title="3. Analysis modules" href="../analysis_modules.html" />
    <link rel="next" title="3.4.1. Nucleic acid analysis — MDAnalysis.analysis.nuclinfo" href="nuclinfo.html" />
    <link rel="prev" title="3.3.1. Generation and Analysis of HOLE pore profiles — MDAnalysis.analysis.hole" href="hole.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nuclinfo.html" title="3.4.1. Nucleic acid analysis — MDAnalysis.analysis.nuclinfo"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="hole.html" title="3.3.1. Generation and Analysis of HOLE pore profiles — MDAnalysis.analysis.hole"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.12.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../analysis_modules.html" accesskey="U">3. Analysis modules</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="hole.html"
                        title="previous chapter">3.3.1. Generation and Analysis of HOLE pore profiles &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.analysis.hole</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nuclinfo.html"
                        title="next chapter">3.4.1. Nucleic acid analysis &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.analysis.nuclinfo</span></code></a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/documentation_pages/analysis/leaflet.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.analysis.leaflet"></span><div class="section" id="leaflet-identification-mdanalysis-analysis-leaflet">
<h1>3.3.2. Leaflet identification &#8212; <a class="reference internal" href="#module-MDAnalysis.analysis.leaflet" title="MDAnalysis.analysis.leaflet"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.analysis.leaflet</span></code></a><a class="headerlink" href="#leaflet-identification-mdanalysis-analysis-leaflet" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Oliver Beckstein</td>
</tr>
<tr class="field-even field"><th class="field-name">Year:</th><td class="field-body">2010</td>
</tr>
<tr class="field-odd field"><th class="field-name">Copyright:</th><td class="field-body">GNU Public License v3</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Algorithm:</dt>
<dd><ol class="first last arabic simple">
<li>build a graph of all phosphate distances &lt; cutoff</li>
<li>identify the largest connected subgraphs</li>
<li>analyse first and second largest graph, which correspond to the leaflets</li>
</ol>
</dd>
</dl>
<p>One can use this information to identify</p>
<ul class="simple">
<li>the upper and lower leaflet of a <em>planar membrane</em> by comparing the
the <a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup.center_of_geometry" title="MDAnalysis.core.AtomGroup.AtomGroup.center_of_geometry"><code class="xref py py-meth docutils literal"><span class="pre">center_of_geometry()</span></code></a> of
the leaflet groups, or</li>
<li>the outer and inner leaflet of a <em>vesicle</em> by comparing histograms
of distances from the centre of geometry (or possibly simply the
<a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup.radius_of_gyration" title="MDAnalysis.core.AtomGroup.AtomGroup.radius_of_gyration"><code class="xref py py-meth docutils literal"><span class="pre">radius_of_gyration()</span></code></a>).</li>
</ul>
<p>See example scripts in the <code class="docutils literal"><span class="pre">examples/</span></code> directory on how to use
<a class="reference internal" href="#MDAnalysis.analysis.leaflet.LeafletFinder" title="MDAnalysis.analysis.leaflet.LeafletFinder"><code class="xref py py-class docutils literal"><span class="pre">LeafletFinder</span></code></a>. The function <a class="reference internal" href="#MDAnalysis.analysis.leaflet.optimize_cutoff" title="MDAnalysis.analysis.leaflet.optimize_cutoff"><code class="xref py py-func docutils literal"><span class="pre">optimize_cutoff()</span></code></a> implements a
(slow) heuristic method to find the best cut off for the LeafletFinder
algorithm.</p>
<dl class="class">
<dt id="MDAnalysis.analysis.leaflet.LeafletFinder">
<em class="property">class </em><code class="descclassname">MDAnalysis.analysis.leaflet.</code><code class="descname">LeafletFinder</code><span class="sig-paren">(</span><em>universe</em>, <em>selectionstring</em>, <em>cutoff=15.0</em>, <em>pbc=False</em>, <em>sparse=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/leaflet.html#LeafletFinder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.leaflet.LeafletFinder" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify atoms in the same leaflet of a lipid bilayer.</p>
<p>The components of the graph are stored in the list
<code class="xref py py-attr docutils literal"><span class="pre">LeafletFinder.components</span></code>; the atoms in each component are numbered
consecutively, starting at 0. To obtain the atoms in the input structure
use <a class="reference internal" href="#MDAnalysis.analysis.leaflet.LeafletFinder.groups" title="MDAnalysis.analysis.leaflet.LeafletFinder.groups"><code class="xref py py-meth docutils literal"><span class="pre">LeafletFinder.groups()</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">L</span> <span class="o">=</span> <span class="n">LeafletFinder</span><span class="p">(</span><span class="n">PDB</span><span class="p">,</span> <span class="s">&#39;name P*&#39;</span><span class="p">)</span>
<span class="n">leaflet0</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">groups</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">leaflet1</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">groups</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>The residues can be accessed through the standard MDAnalysis mechanism:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">leaflet0</span><span class="o">.</span><span class="n">residues</span>
</pre></div>
</div>
<p>provides a <a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.ResidueGroup" title="MDAnalysis.core.AtomGroup.ResidueGroup"><code class="xref py py-class docutils literal"><span class="pre">ResidueGroup</span></code></a>
instance. Similarly, all atoms in the first leaflet are then</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">leaflet0</span><span class="o">.</span><span class="n">residues</span><span class="o">.</span><span class="n">atoms</span>
</pre></div>
</div>
<p>Initialize from a <em>universe</em> or pdb file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>*universe*</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.Universe</span></code> or a PDB file name.</li>
<li><strong>*selection*</strong> &#8211; <a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="MDAnalysis.core.AtomGroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.AtomGroup.AtomGroup</span></code></a> or a
<code class="xref py py-meth docutils literal"><span class="pre">MDAnalysis.Universe.select_atoms()</span></code> selection string
for atoms that define the lipid head groups, e.g.
universe.atoms.PO4 or &#8220;name PO4&#8221; or &#8220;name P*&#8221;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Keywords:</th><td class="field-body"><dl class="first last docutils">
<dt><em>cutoff</em></dt>
<dd><p class="first last">head group-defining atoms within a distance of <em>cutoff</em>
Angstroms are deemed to be in the same leaflet [15.0]</p>
</dd>
<dt><em>pbc</em></dt>
<dd><p class="first last">take periodic boundary conditions into account (only works
for orthorhombic boxes) [<code class="docutils literal"><span class="pre">False</span></code>]</p>
</dd>
<dt><em>sparse</em></dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">None</span></code>: use fastest possible routine; <code class="docutils literal"><span class="pre">True</span></code>: use slow
sparse matrix implementation (for large systems); <code class="docutils literal"><span class="pre">False</span></code>:
use fast <a class="reference internal" href="distances.html#MDAnalysis.analysis.distances.distance_array" title="MDAnalysis.analysis.distances.distance_array"><code class="xref py py-func docutils literal"><span class="pre">distance_array()</span></code></a>
implementation [<code class="docutils literal"><span class="pre">None</span></code>].</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="MDAnalysis.analysis.leaflet.LeafletFinder.group">
<code class="descname">group</code><span class="sig-paren">(</span><em>component_index</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/leaflet.html#LeafletFinder.group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.leaflet.LeafletFinder.group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="MDAnalysis.core.AtomGroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.AtomGroup.AtomGroup</span></code></a> for <em>component_index</em>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.leaflet.LeafletFinder.groups">
<code class="descname">groups</code><span class="sig-paren">(</span><em>component_index=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/leaflet.html#LeafletFinder.groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.leaflet.LeafletFinder.groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup" title="MDAnalysis.core.AtomGroup.AtomGroup"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.AtomGroup.AtomGroup</span></code></a> for <em>component_index</em>.</p>
<p>If no argument is supplied, then a list of all leaflet groups is returned.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.analysis.leaflet.LeafletFinder.group" title="MDAnalysis.analysis.leaflet.LeafletFinder.group"><code class="xref py py-meth docutils literal"><span class="pre">LeafletFinder.group()</span></code></a> and <a class="reference internal" href="#MDAnalysis.analysis.leaflet.LeafletFinder.groups_iter" title="MDAnalysis.analysis.leaflet.LeafletFinder.groups_iter"><code class="xref py py-meth docutils literal"><span class="pre">LeafletFinder.groups_iter()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.leaflet.LeafletFinder.groups_iter">
<code class="descname">groups_iter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/leaflet.html#LeafletFinder.groups_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.leaflet.LeafletFinder.groups_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator over all leaflet <a class="reference internal" href="#MDAnalysis.analysis.leaflet.LeafletFinder.groups" title="MDAnalysis.analysis.leaflet.LeafletFinder.groups"><code class="xref py py-meth docutils literal"><span class="pre">groups()</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.leaflet.LeafletFinder.sizes">
<code class="descname">sizes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/leaflet.html#LeafletFinder.sizes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.leaflet.LeafletFinder.sizes" title="Permalink to this definition">¶</a></dt>
<dd><p>Dict of component index with size of component.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.leaflet.LeafletFinder.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>cutoff=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/leaflet.html#LeafletFinder.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.leaflet.LeafletFinder.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update components, possibly with a different <em>cutoff</em></p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.leaflet.LeafletFinder.write_selection">
<code class="descname">write_selection</code><span class="sig-paren">(</span><em>filename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/leaflet.html#LeafletFinder.write_selection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.leaflet.LeafletFinder.write_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>Write selections for the leaflets to <em>filename</em>.</p>
<p>The format is typically determined by the extension of <em>filename</em>
(e.g. &#8220;vmd&#8221;, &#8220;pml&#8221;, or &#8220;ndx&#8221; for VMD, PyMol, or Gromacs).</p>
<p>See <a class="reference internal" href="../selections/base.html#MDAnalysis.selections.base.SelectionWriter" title="MDAnalysis.selections.base.SelectionWriter"><code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.selections.base.SelectionWriter</span></code></a> for all
options.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="MDAnalysis.analysis.leaflet.optimize_cutoff">
<code class="descclassname">MDAnalysis.analysis.leaflet.</code><code class="descname">optimize_cutoff</code><span class="sig-paren">(</span><em>universe</em>, <em>selection</em>, <em>dmin=10.0</em>, <em>dmax=20.0</em>, <em>step=0.5</em>, <em>max_imbalance=0.2</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/leaflet.html#optimize_cutoff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.leaflet.optimize_cutoff" title="Permalink to this definition">¶</a></dt>
<dd><p>Find cutoff that minimizes number of disconnected groups.</p>
<p>Applies heuristics to find best groups:</p>
<ol class="arabic">
<li><p class="first">at least two groups (assumes that there are at least 2 leaflets)</p>
</li>
<li><p class="first">reject any solutions for which:</p>
<blockquote>
<div><p><cite>|N0 - N1|/|N0 + N1| &gt; *max_imbalance*</cite></p>
</div></blockquote>
<p>Ni = number of lipids in group i. This heuristic picks groups with
balanced numbers of lipids.</p>
</li>
</ol>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>*universe*</strong> &#8211; <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.Universe</span></code> instance</li>
<li><strong>*selection*</strong> &#8211; selection string as used for <a class="reference internal" href="#MDAnalysis.analysis.leaflet.LeafletFinder" title="MDAnalysis.analysis.leaflet.LeafletFinder"><code class="xref py py-class docutils literal"><span class="pre">LeafletFinder</span></code></a></li>
<li><strong>dmax, step</strong> (<em>*dmin*,</em>) &#8211; scan cutoffs from <em>dmin</em> to <em>dmax</em> at stepsize*step (in Angstroms)</li>
<li><strong>*max_imbalance*</strong> &#8211; tuning parameter for the balancing heuristic (2) [0.2]</li>
<li><strong>*kwargs*</strong> &#8211; other arguments for  <a class="reference internal" href="#MDAnalysis.analysis.leaflet.LeafletFinder" title="MDAnalysis.analysis.leaflet.LeafletFinder"><code class="xref py py-class docutils literal"><span class="pre">LeafletFinder</span></code></a></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="docutils literal"><span class="pre">(cutoff,N)</span></code> optimum cutoff and number of groups found</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">can die in various ways if really no appropriate number of groups
can be found; needs to be made more robust</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nuclinfo.html" title="3.4.1. Nucleic acid analysis — MDAnalysis.analysis.nuclinfo"
             >next</a> |</li>
        <li class="right" >
          <a href="hole.html" title="3.3.1. Generation and Analysis of HOLE pore profiles — MDAnalysis.analysis.hole"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.12.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../analysis_modules.html" >3. Analysis modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Joshua Adelman, Jonathan Barnoud,
    Christian Beckstein (logo), Alejandro Bernardin, Sébastien Buchoux,
    David Caplan, Matthieu Chavent, Xavier Deupi, Jan Domański, David L. Dotson
    Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar,
    Benjamin Hall, Joe Jordan, Jinju Lu, Robert McGibbon, Alex Nesterenko,
    Manuel Nuno Melo, Caio S. Souza, Danny Parton, Joshua L. Phillips, Tyler Reddy,
    Paul Rigor, Sean L. Seyler, Andy Somogyi, Lukas Stelzl, Gorman Stock, Isaac Virshup,
    Zhuyi Xue, Carlos Yáñez S.,
    and Oliver Beckstein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>