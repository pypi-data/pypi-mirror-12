// Frontend of Oneline
// @author Nadir Hamid
// @license MIT

var a=(function(){var a={},b={},c=typeof i!='undefined'&&i,d,e,f,g;function h(){return f();};h.main=h;h.module=o;h.packages=a;h.pkg=p;h.require=function i(b){return a.main.index.require(b);};e={};aliases={};return h;function j(){return k(Array.prototype.join.call(arguments,"/"));};function k(a){var b=[],c=a.split('/'),d,e;var f=0,g=c.length-1;for(;f<=g;f++){d=c[f];if(d==="."&&e!==undefined)continue;if(d===".."&&b.length&&e!==".."&&e!=="."&&e!==undefined){b.pop();e=b.slice(-1)[0];}else{if(e===".")b.pop();b.push(d);e=d;}}return b.join("/");};function l(a){return a&&a.substr(0,a.lastIndexOf("/"))||".";};function m(a,b){var c=j(l(a.id),/\.\/$/.test(b)?(b+'index'):b).replace(/\.js$/,''),d=j(c,'index'),e=a.pkg,f;var g=e.modules.length,h;while(g-->0){h=e.modules[g].id;if(h==c||h==d){f=e.modules[g];break;}}return f;}function n(b){function d(f){var g,h;if(/^\./.test(f))g=m(b,f);else if(e&&e.hasOwnProperty(f))return e[f];else if(aliases&&aliases.hasOwnProperty(f))return d(aliases[f]);else{h=a[f];if(!h&&c){try{h=c(f);}catch(i){}if(h)return h;}if(!h)throw new Error('Cannot find module "'+f+'" @[module: '+b.id+' package: '+b.pkg.name+']');g=h.index;}if(!g)throw new Error('Cannot find module "'+f+'" @[module: '+b.id+' package: '+b.pkg.name+']');g.parent=b;return g.call();};return d;}function o(a,c,d){var e={pkg:a,id:c,wrapper:d},g=false;e.exports={};e.require=n(e);e.call=function(){if(g)return e.exports;g=true;b.require=e.require;e.wrapper(e,e.exports,b,b.require);return e.exports;};if(a.mainModuleId==e.id){a.index=e;a.parents.length===0&&(f=e.call);}a.modules.push(e);}function p(){var b=arguments[arguments.length-1],c=Array.prototype.slice.call(arguments,0,arguments.length-1),d=b(c);a[d.name]=d;arguments.length==1&&(a.main=d);return function(a){var b;for(b in a)o(d,b,a[b]);};}}(this));a.pkg(function(a){return{'name':'bson','mainModuleId':'bson','modules':[],'parents':a};})({'binary':function(a,b,c,d,e){if(typeof window==='undefined')var f=d('buffer').Buffer;var g=0;var h=function(a){var b=typeof Uint8Array!='undefined'?new Uint8Array(new ArrayBuffer(a.length)):new Array(a.length);for(var c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b;};var i=function(a,b,c){var d="";for(var e=b;e<c;e++)d=d+String.fromCharCode(a[e]);return d;};function j(a,b){if(!(this instanceof j))return new j(a,b);this._bsontype='Binary';if(a instanceof Number){this.sub_type=a;this.position=0;}else{this.sub_type=b==null?g:b;this.position=0;}if(a!=null&&!(a instanceof Number)){if(typeof a=='string')if(typeof f!='undefined')this.buffer=new f(a);else if(typeof Uint8Array!='undefined'||(Object.prototype.toString.call(a)=='[object Array]'))this.buffer=h(a);else throw new Error("only String, Buffer, Uint8Array or Array accepted");else this.buffer=a;this.position=a.length;}else{if(typeof f!='undefined')this.buffer=new f(j.BUFFER_SIZE);else if(typeof Uint8Array!='undefined')this.buffer=new Uint8Array(new ArrayBuffer(j.BUFFER_SIZE));else this.buffer=new Array(j.BUFFER_SIZE);this.position=0;}};j.prototype.put=function k(a){if(a.length!=null&&typeof a!='number'&&a.length!=1)throw new Error("only accepts single character String, Uint8Array or Array");if(typeof a!='number'&&a<0||a>255)throw new Error("only accepts number in a valid unsigned byte range 0-255");var b=null;if(typeof a=='string')b=a.charCodeAt(0);else if(a.length!=null)b=a[0];else b=a;if(this.buffer.length>this.position)this.buffer[this.position++]=b;else if(typeof f!='undefined'&&f.isBuffer(this.buffer)){var c=new f(j.BUFFER_SIZE+this.buffer.length);this.buffer.copy(c,0,0,this.buffer.length);this.buffer=c;this.buffer[this.position++]=b;}else{var c=null;if(Object.prototype.toString.call(this.buffer)=='[object Uint8Array]')c=new Uint8Array(new ArrayBuffer(j.BUFFER_SIZE+this.buffer.length));else c=new Array(j.BUFFER_SIZE+this.buffer.length);for(var d=0;d<this.buffer.length;d++)c[d]=this.buffer[d];this.buffer=c;this.buffer[this.position++]=b;}};j.prototype.write=function l(a,b){b=typeof b=='number'?b:this.position;if(this.buffer.length<b+a.length){var c=null;if(typeof f!='undefined'&&f.isBuffer(this.buffer)){c=new f(this.buffer.length+a.length);this.buffer.copy(c,0,0,this.buffer.length);}else if(Object.prototype.toString.call(this.buffer)=='[object Uint8Array]'){c=new Uint8Array(new ArrayBuffer(this.buffer.length+a.length));for(var d=0;d<this.position;d++)c[d]=this.buffer[d];}this.buffer=c;}if(typeof f!='undefined'&&f.isBuffer(a)&&f.isBuffer(this.buffer)){a.copy(this.buffer,b,0,a.length);this.position=(b+a.length)>this.position?(b+a.length):this.position;}else if(typeof f!='undefined'&&typeof a=='string'&&f.isBuffer(this.buffer)){this.buffer.write(a,'binary',b);this.position=(b+a.length)>this.position?(b+a.length):this.position;}else if(Object.prototype.toString.call(a)=='[object Uint8Array]'||Object.prototype.toString.call(a)=='[object Array]'&&typeof a!='string'){for(var d=0;d<a.length;d++)this.buffer[b++]=a[d];this.position=b>this.position?b:this.position;}else if(typeof a=='string'){for(var d=0;d<a.length;d++)this.buffer[b++]=a.charCodeAt(d);this.position=b>this.position?b:this.position;}};j.prototype.read=function m(a,b){b=b&&b>0?b:this.position;if(this.buffer.slice)return this.buffer.slice(a,a+b);else{var c=typeof Uint8Array!='undefined'?new Uint8Array(new ArrayBuffer(b)):new Array(b);for(var d=0;d<b;d++)c[d]=this.buffer[a++];}return c;};j.prototype.value=function n(a){a=a==null?false:a;if(typeof f!='undefined'&&f.isBuffer(this.buffer))return a?this.buffer.slice(0,this.position):this.buffer.toString('binary',0,this.position);else if(a)if(this.buffer.slice!=null)return this.buffer.slice(0,this.position);else{var b=Object.prototype.toString.call(this.buffer)=='[object Uint8Array]'?new Uint8Array(new ArrayBuffer(this.position)):new Array(this.position);for(var c=0;c<this.position;c++)b[c]=this.buffer[c];return b;}else return i(this.buffer,0,this.position);};j.prototype.length=function o(){return this.position;};j.prototype.toJSON=function(){return this.buffer!=null?this.buffer.toString('base64'):'';};j.prototype.toString=function(a){return this.buffer!=null?this.buffer.slice(0,this.position).toString(a):'';};j.BUFFER_SIZE=256;j.SUBTYPE_DEFAULT=0;j.SUBTYPE_FUNCTION=1;j.SUBTYPE_BYTE_ARRAY=2;j.SUBTYPE_UUID_OLD=3;j.SUBTYPE_UUID=4;j.SUBTYPE_MD5=5;j.SUBTYPE_USER_DEFINED=128;b.Binary=j;},'binary_parser':function(a,b,c,d,e){var f=String.fromCharCode;var g=[];for(var h=0;h<64;h++)g[h]=Math.pow(2,h);function i(a,b){if(!(this instanceof i))return new i(a,b);this.bigEndian=a;this.allowExceptions=b;};i.warn=function j(a){if(this.allowExceptions)throw new Error(a);return 1;};i.decodeFloat=function k(a,b,c){var d=new this.Buffer(this.bigEndian,a);d.checkBuffer(b+c+1);var e=g[c-1]-1,f=d.readBits(b+c,1),h=d.readBits(b,c),i=0,j=2,k=d.buffer.length+(-b>>3)-1;do for(var l=d.buffer[++k],m=b%8||8,n=1<<m;n>>=1;(l&n)&&(i+=1/j),j*=2);while(b-=m);return h==(e<<1)+1?i?NaN:f?-Infinity:+Infinity:(1+f*-2)*(h||i?!h?Math.pow(2,-e+1)*i:Math.pow(2,h-e)*(1+i):0);};i.decodeInt=function l(a,b,c,d){var e=new this.Buffer(this.bigEndian||d,a),f=e.readBits(0,b),h=g[b];return c&&f>=h/2?f-h:f;};i.encodeFloat=function m(a,b,c){var d=g[c-1]-1,e=-d+1,f=d,h=e-b,i=parseFloat(a),j=isNaN(i)||i==-Infinity||i==+Infinity?i:0,k=0,l=2*d+1+b+3,m=new Array(l),n=(i=j!==0?0:i)<0,o=Math.floor(i=Math.abs(i)),p=i-o,q,r,s,t,u;for(t=l;t;m[--t]=0);for(t=d+2;o&&t;m[--t]=o%2,o=Math.floor(o/2));for(t=d+1;p>0&&t;(m[++t]=((p*=2)>=1)-0)&&--p);for(t=-1;++t<l&&!m[t];);if(m[(q=b-1+(t=(k=d+1-t)>=e&&k<=f?t+1:d+1-(k=e-1)))+1]){if(!(r=m[q]))for(u=q+2;!r&&u<l;r=m[u++]);for(u=q+1;r&&--u>=0;(m[u]=!m[u]-0)&&(r=0));}for(t=t-2<0?-1:t-3;++t<l&&!m[t];);if((k=d+1-t)>=e&&k<=f)++t;else if(k<e){k!=d+1-l&&k<h&&this.warn("encodeFloat::float underflow");t=d+1-(k=e-1);}if(o||j!==0){this.warn(o?"encodeFloat::float overflow":"encodeFloat::"+j);k=f+1;t=d+2;if(j==-Infinity)n=1;else if(isNaN(j))m[t]=1;}for(i=Math.abs(k+d),u=c+1,s="";--u;s=(i%2)+s,i=i>>=1);for(i=0,u=0,t=(s=(n?"1":"0")+s+m.slice(t,t+b).join("")).length,r=[];t;u=(u+1)%8){i+=(1<<u)*s.charAt(--t);if(u==7){r[r.length]=String.fromCharCode(i);i=0;}}r[r.length]=i?String.fromCharCode(i):"";return(this.bigEndian?r.reverse():r).join("");};i.encodeInt=function n(a,b,c,d){var e=g[b];if(a>=e||a<-(e/2)){this.warn("encodeInt::overflow");a=0;}if(a<0)a+=e;for(var f=[];a;f[f.length]=String.fromCharCode(a%256),a=Math.floor(a/256));for(b=-(-b>>3)-f.length;b--;f[f.length]=0);return((this.bigEndian||d)?f.reverse():f).join("");};i.toSmall=function(a){return this.decodeInt(a,8,true);};i.fromSmall=function(a){return this.encodeInt(a,8,true);};i.toByte=function(a){return this.decodeInt(a,8,false);};i.fromByte=function(a){return this.encodeInt(a,8,false);};i.toShort=function(a){return this.decodeInt(a,16,true);};i.fromShort=function(a){return this.encodeInt(a,16,true);};i.toWord=function(a){return this.decodeInt(a,16,false);};i.fromWord=function(a){return this.encodeInt(a,16,false);};i.toInt=function(a){return this.decodeInt(a,32,true);};i.fromInt=function(a){return this.encodeInt(a,32,true);};i.toLong=function(a){return this.decodeInt(a,64,true);};i.fromLong=function(a){return this.encodeInt(a,64,true);};i.toDWord=function(a){return this.decodeInt(a,32,false);};i.fromDWord=function(a){return this.encodeInt(a,32,false);};i.toQWord=function(a){return this.decodeInt(a,64,true);};i.fromQWord=function(a){return this.encodeInt(a,64,true);};i.toFloat=function(a){return this.decodeFloat(a,23,8);};i.fromFloat=function(a){return this.encodeFloat(a,23,8);};i.toDouble=function(a){return this.decodeFloat(a,52,11);};i.fromDouble=function(a){return this.encodeFloat(a,52,11);};i.encode_int32=function o(a,b){var c,d,e,g,h;h=(a<0)?(a+0x100000000):a;c=Math.floor(h/0xffffff);h&=0xffffff;d=Math.floor(h/0xffff);h&=0xffff;e=Math.floor(h/0xff);h&=0xff;g=Math.floor(h);return b?[f(c),f(d),f(e),f(g)]:f(c)+f(d)+f(e)+f(g);};i.encode_int64=function p(a){var b,c,d,e,g,h,i,j,k;k=(a<0)?(a+0x10000000000000000):a;b=Math.floor(k/0xffffffffffffff);k&=0xffffffffffffff;c=Math.floor(k/0xffffffffffff);k&=0xffffffffffff;d=Math.floor(k/0xffffffffff);k&=0xffffffffff;e=Math.floor(k/0xffffffff);k&=0xffffffff;g=Math.floor(k/0xffffff);k&=0xffffff;h=Math.floor(k/0xffff);k&=0xffff;i=Math.floor(k/0xff);k&=0xff;j=Math.floor(k);return f(b)+f(c)+f(d)+f(e)+f(g)+f(h)+f(i)+f(j);};i.decode_utf8=function q(a){var b=a.length,c='',d=0,e=0,f=0,g=0,h;while(d<b){e=a.charCodeAt(d);if(e<128){c+=String.fromCharCode(e);d++;}else if((e>191)&&(e<224)){g=a.charCodeAt(d+1);c+=String.fromCharCode(((e&31)<<6)|(g&63));d+=2;}else{g=a.charCodeAt(d+1);h=a.charCodeAt(d+2);c+=String.fromCharCode(((e&15)<<12)|((g&63)<<6)|(h&63));d+=3;}}return c;};i.encode_cstring=function r(a){return unescape(encodeURIComponent(a))+i.fromByte(0);};i.encode_utf8=function s(a){var b="",c;for(var d=0,e=a.length;d<e;d++){c=a.charCodeAt(d);if(c<128)b+=String.fromCharCode(c);else if((c>127)&&(c<2048)){b+=String.fromCharCode((c>>6)|192);b+=String.fromCharCode((c&63)|128);}else{b+=String.fromCharCode((c>>12)|224);b+=String.fromCharCode(((c>>6)&63)|128);b+=String.fromCharCode((c&63)|128);}}return b;};i.hprint=function t(a){var b;for(var c=0,d=a.length;c<d;c++)if(a.charCodeAt(c)<32){b=a.charCodeAt(c)<=15?"0"+a.charCodeAt(c).toString(16):a.charCodeAt(c).toString(16);process.stdout.write(b+" ");}else{b=a.charCodeAt(c)<=15?"0"+a.charCodeAt(c).toString(16):a.charCodeAt(c).toString(16);process.stdout.write(b+" ");}process.stdout.write("\n\n");};i.ilprint=function t(a){var b;for(var c=0,e=a.length;c<e;c++)if(a.charCodeAt(c)<32){b=a.charCodeAt(c)<=15?"0"+a.charCodeAt(c).toString(10):a.charCodeAt(c).toString(10);d('util').debug(b+' : ');}else{b=a.charCodeAt(c)<=15?"0"+a.charCodeAt(c).toString(10):a.charCodeAt(c).toString(10);d('util').debug(b+' : '+a.charAt(c));}};i.hlprint=function t(a){var b;for(var c=0,e=a.length;c<e;c++)if(a.charCodeAt(c)<32){b=a.charCodeAt(c)<=15?"0"+a.charCodeAt(c).toString(16):a.charCodeAt(c).toString(16);d('util').debug(b+' : ');}else{b=a.charCodeAt(c)<=15?"0"+a.charCodeAt(c).toString(16):a.charCodeAt(c).toString(16);d('util').debug(b+' : '+a.charAt(c));}};function u(a,b){this.bigEndian=a||0;this.buffer=[];this.setBuffer(b);};u.prototype.setBuffer=function v(a){var b,c,d;if(a){c=b=a.length;d=this.buffer=new Array(b);for(;c;d[b-c]=a.charCodeAt(--c));this.bigEndian&&d.reverse();}};u.prototype.hasNeededBits=function w(a){return this.buffer.length>=-(-a>>3);};u.prototype.checkBuffer=function x(a){if(!this.hasNeededBits(a))throw new Error("checkBuffer::missing bytes");};u.prototype.readBits=function y(a,b){function c(a,b){for(;b--;a=((a%=0x7fffffff+1)&0x40000000)==0x40000000?a*2:(a-0x40000000)*2+0x7fffffff+1);return a;}if(a<0||b<=0)return 0;this.checkBuffer(a+b);var d,e=a%8,f=this.buffer.length-(a>>3)-1,g=this.buffer.length+(-(a+b)>>3),h=f-g,i=((this.buffer[f]>>e)&((1<<(h?8-e:b))-1))+(h&&(d=(a+b)%8)?(this.buffer[g++]&((1<<d)-1))<<(h--<<3)-e:0);for(;h;i+=c(this.buffer[g++],(h--<<3)-e));return i;};i.Buffer=u;b.BinaryParser=i;},'bson':function(a,b,c,d,e){var f=d('./long').Long,g=d('./double').Double,h=d('./timestamp').Timestamp,i=d('./objectid').ObjectID,j=d('./symbol').Symbol,k=d('./code').Code,l=d('./min_key').MinKey,m=d('./max_key').MaxKey,n=d('./db_ref').DBRef,o=d('./binary').Binary,p=d('./binary_parser').BinaryParser,q=d('./float_parser').writeIEEE754,r=d('./float_parser').readIEEE754;var s=function s(a){return typeof a==='object'&&Object.prototype.toString.call(a)==='[object Date]';};function t(){};t.BSON_INT32_MAX=0x7FFFFFFF;t.BSON_INT32_MIN=-0x80000000;t.BSON_INT64_MAX=Math.pow(2,63)-1;t.BSON_INT64_MIN=-Math.pow(2,63);t.JS_INT_MAX=0x20000000000000;t.JS_INT_MIN=-0x20000000000000;var u=f.fromNumber(0x20000000000000);var v=f.fromNumber(-0x20000000000000);t.BSON_DATA_NUMBER=1;t.BSON_DATA_STRING=2;t.BSON_DATA_OBJECT=3;t.BSON_DATA_ARRAY=4;t.BSON_DATA_BINARY=5;t.BSON_DATA_OID=7;t.BSON_DATA_BOOLEAN=8;t.BSON_DATA_DATE=9;t.BSON_DATA_NULL=10;t.BSON_DATA_REGEXP=11;t.BSON_DATA_CODE=13;t.BSON_DATA_SYMBOL=14;t.BSON_DATA_CODE_W_SCOPE=15;t.BSON_DATA_INT=16;t.BSON_DATA_TIMESTAMP=17;t.BSON_DATA_LONG=18;t.BSON_DATA_MIN_KEY=0xff;t.BSON_DATA_MAX_KEY=0x7f;t.BSON_BINARY_SUBTYPE_DEFAULT=0;t.BSON_BINARY_SUBTYPE_FUNCTION=1;t.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2;t.BSON_BINARY_SUBTYPE_UUID=3;t.BSON_BINARY_SUBTYPE_MD5=4;t.BSON_BINARY_SUBTYPE_USER_DEFINED=128;t.calculateObjectSize=function w(a,b){var c=(4+1);if(Array.isArray(a))for(var d=0;d<a.length;d++)c+=x(d.toString(),a[d],b);else{if(a.toBSON)a=a.toBSON();for(var e in a)c+=x(e,a[e],b);}return c;};function x(a,b,c){var d=typeof Buffer!=='undefined';switch(typeof b){case 'string':return 1+(!d?B(a):Buffer.byteLength(a,'utf8'))+1+4+(!d?B(b):Buffer.byteLength(b,'utf8'))+1;case 'number':if(Math.floor(b)===b&&b>=t.JS_INT_MIN&&b<=t.JS_INT_MAX)if(b>=t.BSON_INT32_MIN&&b<=t.BSON_INT32_MAX)return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+(4+1);else return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+(8+1);else return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+(8+1);case 'undefined':return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+1;case 'boolean':return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+(1+1);case 'object':if(b==null||b instanceof l||b instanceof m||b._bsontype=='MinKey'||b._bsontype=='MaxKey')return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+1;else if(b instanceof i||b._bsontype=='ObjectID')return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+(12+1);else if(b instanceof Date||s(b))return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+(8+1);else if(typeof Buffer!=='undefined'&&Buffer.isBuffer(b))return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+(1+4+1)+b.length;else if(b instanceof f||b instanceof g||b instanceof h||b._bsontype=='Long'||b._bsontype=='Double'||b._bsontype=='Timestamp')return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+(8+1);else if(b instanceof k||b._bsontype=='Code')if(b.scope!=null&&Object.keys(b.scope).length>0)return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+1+4+4+(!d?B(b.code.toString()):Buffer.byteLength(b.code.toString(),'utf8'))+1+t.calculateObjectSize(b.scope,c);else return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+1+4+(!d?B(b.code.toString()):Buffer.byteLength(b.code.toString(),'utf8'))+1;else if(b instanceof o||b._bsontype=='Binary')if(b.sub_type==o.SUBTYPE_BYTE_ARRAY)return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+(b.position+1+4+1+4);else return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+(b.position+1+4+1);else if(b instanceof j||b._bsontype=='Symbol')return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+((!d?B(b.value):Buffer.byteLength(b.value,'utf8'))+4+1+1);else if(b instanceof n||b._bsontype=='DBRef'){var e={'$ref':b.namespace,'$id':b.oid};if(null!=b.db)e.$db=b.db;return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+1+t.calculateObjectSize(e,c);}else if(b instanceof RegExp||Object.prototype.toString.call(b)==='[object RegExp]')return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+1+(!d?B(b.source):Buffer.byteLength(b.source,'utf8'))+1+(b.global?1:0)+(b.ignoreCase?1:0)+(b.multiline?1:0)+1;else return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+t.calculateObjectSize(b,c)+1;case 'function':if(b instanceof RegExp||Object.prototype.toString.call(b)==='[object RegExp]'||String.call(b)=='[object RegExp]')return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+1+(!d?B(b.source):Buffer.byteLength(b.source,'utf8'))+1+(b.global?1:0)+(b.ignoreCase?1:0)+(b.multiline?1:0)+1;else if(c&&b.scope!=null&&Object.keys(b.scope).length>0)return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+1+4+4+(!d?B(b.toString()):Buffer.byteLength(b.toString(),'utf8'))+1+t.calculateObjectSize(b.scope,c);else if(c)return(a!=null?((!d?B(a):Buffer.byteLength(a,'utf8'))+1):0)+1+4+(!d?B(b.toString()):Buffer.byteLength(b.toString(),'utf8'))+1;}return 0;}t.serializeWithBufferAndIndex=function y(a,b,c,d,e){e=e==null?false:e;var f=c.length;c[d++]=f&0xff;c[d++]=(f>>8)&0xff;c[d++]=(f>>16)&0xff;c[d++]=(f>>24)&0xff;return z(a,b,c,d,e)-1;};var z=function(a,b,c,d,e){if(Array.isArray(a))for(var f=0;f<a.length;f++)d=E(f.toString(),a[f],b,c,d,e);else{if(a.toBSON)a=a.toBSON();for(var g in a){if(g!='$db'&&g!='$ref'&&g!='$id')t.checkKey(g,!b);d=E(g,a[g],b,c,d,e);}}c[d++]=0;return d;};var A=function(a){var b,c,d=[];for(var e=0;e<a.length;e++){b=a.charCodeAt(e);c=[];do{c.push(b&0xFF);b=b>>8;}while(b);d=d.concat(c.reverse());}return d;};var B=function(a){var b,c,d=0;for(var e=0;e<a.length;e++){b=a.charCodeAt(e);c=[];do{c.push(b&0xFF);b=b>>8;}while(b);d=d+c.length;}return d;};var C=function(a,b,c){var d=A(b);for(var e=0;e<d.length;e++)a[c+e]=d[e];return d.length;};var D=typeof Buffer!='undefined';var E=function(a,b,c,d,e,p){var r=e;switch(typeof b){case 'string':d[e++]=t.BSON_DATA_STRING;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var v=D?Buffer.byteLength(b)+1:B(b)+1;d[e+3]=(v>>24)&0xff;d[e+2]=(v>>16)&0xff;d[e+1]=(v>>8)&0xff;d[e]=v&0xff;e=e+4;D?d.write(b,e,'utf8'):C(d,b,e);e=e+v-1;d[e++]=0;return e;case 'number':if(Math.floor(b)===b&&b>=t.JS_INT_MIN&&b<=t.JS_INT_MAX)if(b>=t.BSON_INT32_MIN&&b<=t.BSON_INT32_MAX){d[e++]=t.BSON_DATA_INT;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;d[e++]=b&0xff;d[e++]=(b>>8)&0xff;d[e++]=(b>>16)&0xff;d[e++]=(b>>24)&0xff;}else if(b>=t.JS_INT_MIN&&b<=t.JS_INT_MAX){d[e++]=t.BSON_DATA_NUMBER;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;q(d,b,e,'little',52,8);e=e+8;}else{d[e++]=t.BSON_DATA_LONG;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var w=f.fromNumber(b);var x=w.getLowBits();var y=w.getHighBits();d[e++]=x&0xff;d[e++]=(x>>8)&0xff;d[e++]=(x>>16)&0xff;d[e++]=(x>>24)&0xff;d[e++]=y&0xff;d[e++]=(y>>8)&0xff;d[e++]=(y>>16)&0xff;d[e++]=(y>>24)&0xff;}else{d[e++]=t.BSON_DATA_NUMBER;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;q(d,b,e,'little',52,8);e=e+8;}return e;case 'undefined':d[e++]=t.BSON_DATA_NULL;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;return e;case 'boolean':d[e++]=t.BSON_DATA_BOOLEAN;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;d[e++]=b?1:0;return e;case 'object':if(b===null||b instanceof l||b instanceof m||b._bsontype=='MinKey'||b._bsontype=='MaxKey'){if(b===null)d[e++]=t.BSON_DATA_NULL;else if(b instanceof l)d[e++]=t.BSON_DATA_MIN_KEY;else d[e++]=t.BSON_DATA_MAX_KEY;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;return e;}else if(b instanceof i||b._bsontype=='ObjectID'){d[e++]=t.BSON_DATA_OID;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;D?d.write(b.id,e,'binary'):C(d,b.id,e);e=e+12;return e;}else if(b instanceof Date||s(b)){d[e++]=t.BSON_DATA_DATE;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var A=f.fromNumber(b.getTime());var x=A.getLowBits();var y=A.getHighBits();d[e++]=x&0xff;d[e++]=(x>>8)&0xff;d[e++]=(x>>16)&0xff;d[e++]=(x>>24)&0xff;d[e++]=y&0xff;d[e++]=(y>>8)&0xff;d[e++]=(y>>16)&0xff;d[e++]=(y>>24)&0xff;return e;}else if(typeof Buffer!=='undefined'&&Buffer.isBuffer(b)){d[e++]=t.BSON_DATA_BINARY;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var v=b.length;d[e++]=v&0xff;d[e++]=(v>>8)&0xff;d[e++]=(v>>16)&0xff;d[e++]=(v>>24)&0xff;d[e++]=t.BSON_BINARY_SUBTYPE_DEFAULT;b.copy(d,e,0,v);e=e+v;return e;}else if(b instanceof f||b instanceof h||b._bsontype=='Long'||b._bsontype=='Timestamp'){d[e++]=b instanceof f?t.BSON_DATA_LONG:t.BSON_DATA_TIMESTAMP;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var x=b.getLowBits();var y=b.getHighBits();d[e++]=x&0xff;d[e++]=(x>>8)&0xff;d[e++]=(x>>16)&0xff;d[e++]=(x>>24)&0xff;d[e++]=y&0xff;d[e++]=(y>>8)&0xff;d[e++]=(y>>16)&0xff;d[e++]=(y>>24)&0xff;return e;}else if(b instanceof g||b._bsontype=='Double'){d[e++]=t.BSON_DATA_NUMBER;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;q(d,b,e,'little',52,8);e=e+8;return e;}else if(b instanceof k||b._bsontype=='Code')if(b.scope!=null&&Object.keys(b.scope).length>0){d[e++]=t.BSON_DATA_CODE_W_SCOPE;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var E=t.calculateObjectSize(b.scope,p);var F=b.code.toString();var G=D?Buffer.byteLength(F)+1:B(F)+1;var H=4+G+E+4;d[e++]=H&0xff;d[e++]=(H>>8)&0xff;d[e++]=(H>>16)&0xff;d[e++]=(H>>24)&0xff;d[e++]=G&0xff;d[e++]=(G>>8)&0xff;d[e++]=(G>>16)&0xff;d[e++]=(G>>24)&0xff;D?d.write(F,e,'utf8'):C(d,F,e);e=e+G-1;d[e++]=0;var I=D?new Buffer(E):new Uint8Array(new ArrayBuffer(E));z(b.scope,c,I,0,p);var J=E;d[e++]=J&0xff;d[e++]=(J>>8)&0xff;d[e++]=(J>>16)&0xff;d[e++]=(J>>24)&0xff;D?I.copy(d,e,0,E):d.set(I,e);e=e+J-5;d[e++]=0;return e;}else{d[e++]=t.BSON_DATA_CODE;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var F=b.code.toString();var v=D?Buffer.byteLength(F)+1:B(F)+1;d[e++]=v&0xff;d[e++]=(v>>8)&0xff;d[e++]=(v>>16)&0xff;d[e++]=(v>>24)&0xff;D?d.write(F,e,'utf8'):C(d,F,e);e=e+v-1;d[e++]=0;return e;}else if(b instanceof o||b._bsontype=='Binary'){d[e++]=t.BSON_DATA_BINARY;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var K=b.value(true);var v=b.position;d[e++]=v&0xff;d[e++]=(v>>8)&0xff;d[e++]=(v>>16)&0xff;d[e++]=(v>>24)&0xff;d[e++]=b.sub_type;if(b.sub_type==o.SUBTYPE_BYTE_ARRAY){d[e++]=v&0xff;d[e++]=(v>>8)&0xff;d[e++]=(v>>16)&0xff;d[e++]=(v>>24)&0xff;}D?K.copy(d,e,0,b.position):d.set(K,e);e=e+b.position;return e;}else if(b instanceof j||b._bsontype=='Symbol'){d[e++]=t.BSON_DATA_SYMBOL;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var v=D?Buffer.byteLength(b.value)+1:B(b.value)+1;d[e++]=v&0xff;d[e++]=(v>>8)&0xff;d[e++]=(v>>16)&0xff;d[e++]=(v>>24)&0xff;d.write(b.value,e,'utf8');e=e+v-1;d[e++]=0x00;return e;}else if(b instanceof n||b._bsontype=='DBRef'){d[e++]=t.BSON_DATA_OBJECT;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var L={'$ref':b.namespace,'$id':b.oid};if(null!=b.db)L.$db=b.db;var v=t.calculateObjectSize(L,p);var M=t.serializeWithBufferAndIndex(L,c,d,e,p);d[e++]=v&0xff;d[e++]=(v>>8)&0xff;d[e++]=(v>>16)&0xff;d[e++]=(v>>24)&0xff;d[M++]=0x00;return M;}else if(b instanceof RegExp||Object.prototype.toString.call(b)==='[object RegExp]'){d[e++]=t.BSON_DATA_REGEXP;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;D?d.write(b.source,e,'utf8'):C(d,b.source,e);e=e+(D?Buffer.byteLength(b.source):B(b.source));d[e++]=0x00;if(b.global)d[e++]=0x73;if(b.ignoreCase)d[e++]=0x69;if(b.multiline)d[e++]=0x6d;d[e++]=0x00;return e;}else{d[e++]=Array.isArray(b)?t.BSON_DATA_ARRAY:t.BSON_DATA_OBJECT;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var M=z(b,c,d,e+4,p);var v=M-e;d[e++]=v&0xff;d[e++]=(v>>8)&0xff;d[e++]=(v>>16)&0xff;d[e++]=(v>>24)&0xff;return M;}case 'function':if(b instanceof RegExp||Object.prototype.toString.call(b)==='[object RegExp]'||String.call(b)=='[object RegExp]'){d[e++]=t.BSON_DATA_REGEXP;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;d.write(b.source,e,'utf8');e=e+(D?Buffer.byteLength(b.source):B(b.source));d[e++]=0x00;if(b.global)d[e++]=0x73;if(b.ignoreCase)d[e++]=0x69;if(b.multiline)d[e++]=0x6d;d[e++]=0x00;return e;}else if(p&&b.scope!=null&&Object.keys(b.scope).length>0){d[e++]=t.BSON_DATA_CODE_W_SCOPE;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var E=t.calculateObjectSize(b.scope,p);var F=b.toString();var G=D?Buffer.byteLength(F)+1:B(F)+1;var H=4+G+E;d[e++]=H&0xff;d[e++]=(H>>8)&0xff;d[e++]=(H>>16)&0xff;d[e++]=(H>>24)&0xff;d[e++]=G&0xff;d[e++]=(G>>8)&0xff;d[e++]=(G>>16)&0xff;d[e++]=(G>>24)&0xff;D?d.write(F,e,'utf8'):C(d,F,e);e=e+G-1;d[e++]=0;var I=new Buffer(E);z(b.scope,c,I,0,p);var J=E-4;d[e++]=J&0xff;d[e++]=(J>>8)&0xff;d[e++]=(J>>16)&0xff;d[e++]=(J>>24)&0xff;I.copy(d,e,0,E);e=e+J-5;d[e++]=0;return e;}else if(p){d[e++]=t.BSON_DATA_CODE;var u=D?d.write(a,e,'utf8'):C(d,a,e);e=e+u+1;d[e-1]=0;var F=b.toString();var v=D?Buffer.byteLength(F)+1:B(F)+1;d[e++]=v&0xff;d[e++]=(v>>8)&0xff;d[e++]=(v>>16)&0xff;d[e++]=(v>>24)&0xff;D?d.write(F,e,'utf8'):C(d,F,e);e=e+v-1;d[e++]=0;return e;}}return e;};t.serialize=function(a,b,c,d){if(a==null||typeof a!='object'||Array.isArray(a))throw new Error("Only javascript objects supported");var e=null;var f=t.calculateObjectSize(a,d);if(e=typeof Buffer!='undefined'){e=new Buffer(f);c=true;}else if(typeof Uint8Array!='undefined')e=new Uint8Array(new ArrayBuffer(f));else e=new Array(f);t.serializeWithBufferAndIndex(a,b,e,0,d);return e;};var F=t.functionCache={};var G=[0x00000000,0x77073096,0xEE0E612C,0x990951BA,0x076DC419,0x706AF48F,0xE963A535,0x9E6495A3,0x0EDB8832,0x79DCB8A4,0xE0D5E91E,0x97D2D988,0x09B64C2B,0x7EB17CBD,0xE7B82D07,0x90BF1D91,0x1DB71064,0x6AB020F2,0xF3B97148,0x84BE41DE,0x1ADAD47D,0x6DDDE4EB,0xF4D4B551,0x83D385C7,0x136C9856,0x646BA8C0,0xFD62F97A,0x8A65C9EC,0x14015C4F,0x63066CD9,0xFA0F3D63,0x8D080DF5,0x3B6E20C8,0x4C69105E,0xD56041E4,0xA2677172,0x3C03E4D1,0x4B04D447,0xD20D85FD,0xA50AB56B,0x35B5A8FA,0x42B2986C,0xDBBBC9D6,0xACBCF940,0x32D86CE3,0x45DF5C75,0xDCD60DCF,0xABD13D59,0x26D930AC,0x51DE003A,0xC8D75180,0xBFD06116,0x21B4F4B5,0x56B3C423,0xCFBA9599,0xB8BDA50F,0x2802B89E,0x5F058808,0xC60CD9B2,0xB10BE924,0x2F6F7C87,0x58684C11,0xC1611DAB,0xB6662D3D,0x76DC4190,0x01DB7106,0x98D220BC,0xEFD5102A,0x71B18589,0x06B6B51F,0x9FBFE4A5,0xE8B8D433,0x7807C9A2,0x0F00F934,0x9609A88E,0xE10E9818,0x7F6A0DBB,0x086D3D2D,0x91646C97,0xE6635C01,0x6B6B51F4,0x1C6C6162,0x856530D8,0xF262004E,0x6C0695ED,0x1B01A57B,0x8208F4C1,0xF50FC457,0x65B0D9C6,0x12B7E950,0x8BBEB8EA,0xFCB9887C,0x62DD1DDF,0x15DA2D49,0x8CD37CF3,0xFBD44C65,0x4DB26158,0x3AB551CE,0xA3BC0074,0xD4BB30E2,0x4ADFA541,0x3DD895D7,0xA4D1C46D,0xD3D6F4FB,0x4369E96A,0x346ED9FC,0xAD678846,0xDA60B8D0,0x44042D73,0x33031DE5,0xAA0A4C5F,0xDD0D7CC9,0x5005713C,0x270241AA,0xBE0B1010,0xC90C2086,0x5768B525,0x206F85B3,0xB966D409,0xCE61E49F,0x5EDEF90E,0x29D9C998,0xB0D09822,0xC7D7A8B4,0x59B33D17,0x2EB40D81,0xB7BD5C3B,0xC0BA6CAD,0xEDB88320,0x9ABFB3B6,0x03B6E20C,0x74B1D29A,0xEAD54739,0x9DD277AF,0x04DB2615,0x73DC1683,0xE3630B12,0x94643B84,0x0D6D6A3E,0x7A6A5AA8,0xE40ECF0B,0x9309FF9D,0x0A00AE27,0x7D079EB1,0xF00F9344,0x8708A3D2,0x1E01F268,0x6906C2FE,0xF762575D,0x806567CB,0x196C3671,0x6E6B06E7,0xFED41B76,0x89D32BE0,0x10DA7A5A,0x67DD4ACC,0xF9B9DF6F,0x8EBEEFF9,0x17B7BE43,0x60B08ED5,0xD6D6A3E8,0xA1D1937E,0x38D8C2C4,0x4FDFF252,0xD1BB67F1,0xA6BC5767,0x3FB506DD,0x48B2364B,0xD80D2BDA,0xAF0A1B4C,0x36034AF6,0x41047A60,0xDF60EFC3,0xA867DF55,0x316E8EEF,0x4669BE79,0xCB61B38C,0xBC66831A,0x256FD2A0,0x5268E236,0xCC0C7795,0xBB0B4703,0x220216B9,0x5505262F,0xC5BA3BBE,0xB2BD0B28,0x2BB45A92,0x5CB36A04,0xC2D7FFA7,0xB5D0CF31,0x2CD99E8B,0x5BDEAE1D,0x9B64C2B0,0xEC63F226,0x756AA39C,0x026D930A,0x9C0906A9,0xEB0E363F,0x72076785,0x05005713,0x95BF4A82,0xE2B87A14,0x7BB12BAE,0x0CB61B38,0x92D28E9B,0xE5D5BE0D,0x7CDCEFB7,0x0BDBDF21,0x86D3D2D4,0xF1D4E242,0x68DDB3F8,0x1FDA836E,0x81BE16CD,0xF6B9265B,0x6FB077E1,0x18B74777,0x88085AE6,0xFF0F6A70,0x66063BCA,0x11010B5C,0x8F659EFF,0xF862AE69,0x616BFFD3,0x166CCF45,0xA00AE278,0xD70DD2EE,0x4E048354,0x3903B3C2,0xA7672661,0xD06016F7,0x4969474D,0x3E6E77DB,0xAED16A4A,0xD9D65ADC,0x40DF0B66,0x37D83BF0,0xA9BCAE53,0xDEBB9EC5,0x47B2CF7F,0x30B5FFE9,0xBDBDF21C,0xCABAC28A,0x53B39330,0x24B4A3A6,0xBAD03605,0xCDD70693,0x54DE5729,0x23D967BF,0xB3667A2E,0xC4614AB8,0x5D681B02,0x2A6F2B94,0xB40BBE37,0xC30C8EA1,0x5A05DF1B,0x2D02EF8D];var H=function(a,b,c){var d=0;var e=0;var f=0;d=d^(-1);for(var g=b,h=c;g<h;g++){f=(d^a[g])&0xFF;e=G[f];d=(d>>>8)^e;}return d^(-1);};t.deserializeStream=function(a,b,c,d,e,f){f=f!=null?f:{};var g=b;for(var h=0;h<c;h++){var i=a[g]|a[g+1]<<8|a[g+2]<<16|a[g+3]<<24;f.index=g;d[e+h]=t.deserialize(a,f);g=g+i;}return g;};var I=function(a,b,c,d){var e=null;if(a[b]==null){eval("value = "+c);a[b]=e;}return a[b].bind(d);};var J=function(a){var b=null;eval("value = "+a);return b;};var K=function(a,b,c){return p.decode_utf8(L(a,b,c));};var L=function(a,b,c){var d="";for(var e=b;e<c;e++)d=d+String.fromCharCode(a[e]);return d;};t.deserialize=function(a,b,c){b=b==null?{}:b;var d=b.evalFunctions==null?false:b.evalFunctions;var e=b.cacheFunctions==null?false:b.cacheFunctions;var g=b.cacheFunctionsCrc32==null?false:b.cacheFunctionsCrc32;var p=b.promoteLongs||true;if(a.length<5)throw new Error("corrupt bson message < 5 bytes long");var q=typeof b.index=='number'?b.index:0;var s=function(){var b=q;while(a[b]!==0x00)b++;var c=D&&Buffer.isBuffer(a)?a.toString('utf8',q,b):K(a,q,b);q=b+1;return c;};var w=c?[]:{};var x=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;if(x<5||x>a.length)throw new Error("corrupt bson message");while(true){var y=a[q++];if(y==0)break;var z=s();switch(y){case t.BSON_DATA_OID:var A=D&&Buffer.isBuffer(a)?a.toString('binary',q,q+12):L(a,q,q+12);w[z]=new i(A);q=q+12;break;case t.BSON_DATA_STRING:var B=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;w[z]=D&&Buffer.isBuffer(a)?a.toString('utf8',q,q+B-1):K(a,q,q+B-1);q=q+B;break;case t.BSON_DATA_INT:w[z]=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;break;case t.BSON_DATA_NUMBER:w[z]=r(a,q,'little',52,8);q=q+8;break;case t.BSON_DATA_DATE:var C=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;var E=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;w[z]=new Date(new f(C,E).toNumber());break;case t.BSON_DATA_BOOLEAN:w[z]=a[q++]==1;break;case t.BSON_DATA_NULL:w[z]=null;break;case t.BSON_DATA_BINARY:var G=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;var M=a[q++];if(a.slice!=null){if(M==o.SUBTYPE_BYTE_ARRAY)G=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;w[z]=new o(a.slice(q,q+G),M);}else{var N=typeof Uint8Array!='undefined'?new Uint8Array(new ArrayBuffer(G)):new Array(G);if(M==o.SUBTYPE_BYTE_ARRAY)G=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;for(var O=0;O<G;O++)N[O]=a[q+O];w[z]=new o(N,M);}q=q+G;break;case t.BSON_DATA_ARRAY:b.index=q;var P=a[q]|a[q+1]<<8|a[q+2]<<16|a[q+3]<<24;w[z]=t.deserialize(a,b,true);q=q+P;break;case t.BSON_DATA_OBJECT:b.index=q;var P=a[q]|a[q+1]<<8|a[q+2]<<16|a[q+3]<<24;w[z]=t.deserialize(a,b,false);q=q+P;break;case t.BSON_DATA_REGEXP:var Q=s();var R=s();var S=new Array(R.length);for(var O=0;O<R.length;O++)switch(R[O]){case 'm':S[O]='m';break;case 's':S[O]='g';break;case 'i':S[O]='i';break;}w[z]=new RegExp(Q,S.join(''));break;case t.BSON_DATA_LONG:var C=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;var E=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;var T=new f(C,E);if(p)w[z]=T.lessThanOrEqual(u)&&T.greaterThanOrEqual(v)?T.toNumber():T;else w[z]=T;break;case t.BSON_DATA_SYMBOL:var B=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;w[z]=new j(a.toString('utf8',q,q+B-1));q=q+B;break;case t.BSON_DATA_TIMESTAMP:var C=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;var E=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;w[z]=new h(C,E);break;case t.BSON_DATA_MIN_KEY:w[z]=new l();break;case t.BSON_DATA_MAX_KEY:w[z]=new m();break;case t.BSON_DATA_CODE:var B=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;var U=D&&Buffer.isBuffer(a)?a.toString('utf8',q,q+B-1):K(a,q,q+B-1);if(d){var V=null;if(e){var W=g?H(U):U;w[z]=I(F,W,U,w);}else w[z]=J(U);}else w[z]=new k(U,{});q=q+B;break;case t.BSON_DATA_CODE_W_SCOPE:var X=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;var B=a[q++]|a[q++]<<8|a[q++]<<16|a[q++]<<24;var U=D&&Buffer.isBuffer(a)?a.toString('utf8',q,q+B-1):K(a,q,q+B-1);q=q+B;b.index=q;var P=a[q]|a[q+1]<<8|a[q+2]<<16|a[q+3]<<24;var Y=t.deserialize(a,b,false);q=q+P;if(d){var V=null;if(e){var W=g?H(U):U;w[z]=I(F,W,U,w);}else w[z]=J(U);w[z].scope=Y;}else w[z]=new k(U,Y);break;}}if(w.$id!=null)w=new n(w.$ref,w.$id,w.$db);return w;};t.checkKey=function M(a,b){if(!a.length)return;if(!!~a.indexOf("\x00"))throw Error("key "+a+" must not contain null bytes");if(!b)if('$'==a[0])throw Error("key "+a+" must not start with '$'");else if(!!~a.indexOf('.'))throw Error("key "+a+" must not contain '.'");};t.prototype.deserialize=function(a,b){return t.deserialize(a,b);};t.prototype.deserializeStream=function(a,b,c,d,e,f){return t.deserializeStream(a,b,c,d,e,f);};t.prototype.serialize=function(a,b,c,d){return t.serialize(a,b,c,d);};t.prototype.calculateObjectSize=function(a,b){return t.calculateObjectSize(a,b);};t.prototype.serializeWithBufferAndIndex=function(a,b,c,d,e){return t.serializeWithBufferAndIndex(a,b,c,d,e);};b.Code=k;b.Symbol=j;b.BSON=t;b.DBRef=n;b.Binary=o;b.ObjectID=i;b.Long=f;b.Timestamp=h;b.Double=g;b.MinKey=l;b.MaxKey=m;},'code':function(a,b,c,d,e){function f(a,b){if(!(this instanceof f))return new f(a,b);this._bsontype='Code';this.code=a;this.scope=b==null?{}:b;};f.prototype.toJSON=function(){return{scope:this.scope,code:this.code};};b.Code=f;},'db_ref':function(a,b,c,d,e){function f(a,b,c){if(!(this instanceof f))return new f(a,b,c);this._bsontype='DBRef';this.namespace=a;this.oid=b;this.db=c;};f.prototype.toJSON=function(){return{'$ref':this.namespace,'$id':this.oid,'$db':this.db==null?'':this.db};};b.DBRef=f;},'double':function(a,b,c,d,e){function f(a){if(!(this instanceof f))return new f(a);this._bsontype='Double';this.value=a;}f.prototype.valueOf=function(){return this.value;};f.prototype.toJSON=function(){return this.value;};b.Double=f;},'float_parser':function(a,b,c,d,e){var f=function(a,b,c,d,e){var f,g,h=(c==='big'),i=e*8-d-1,j=(1<<i)-1,k=j>>1,l=-7,m=h?0:(e-1),n=h?1:-1,o=a[b+m];m+=n;f=o&((1<<(-l))-1);o>>=(-l);l+=i;for(;l>0;f=f*256+a[b+m],m+=n,l-=8);g=f&((1<<(-l))-1);f>>=(-l);l+=d;for(;l>0;g=g*256+a[b+m],m+=n,l-=8);if(f===0)f=1-k;else if(f===j)return g?NaN:((o?-1:1)*Infinity);else{g=g+Math.pow(2,d);f=f-k;}return(o?-1:1)*g*Math.pow(2,f-d);};var g=function(a,b,c,d,e,f){var g,h,i,j=(d==='big'),k=f*8-e-1,l=(1<<k)-1,m=l>>1,n=(e===23?Math.pow(2,-24)-Math.pow(2,-77):0),o=j?(f-1):0,p=j?-1:1,q=b<0||(b===0&&1/b<0)?1:0;b=Math.abs(b);if(isNaN(b)||b===Infinity){h=isNaN(b)?1:0;g=l;}else{g=Math.floor(Math.log(b)/Math.LN2);if(b*(i=Math.pow(2,-g))<1){g--;i*=2;}if(g+m>=1)b+=n/i;else b+=n*Math.pow(2,1-m);if(b*i>=2){g++;i/=2;}if(g+m>=l){h=0;g=l;}else if(g+m>=1){h=(b*i-1)*Math.pow(2,e);g=g+m;}else{h=b*Math.pow(2,m-1)*Math.pow(2,e);g=0;}}for(;e>=8;a[c+o]=h&0xff,o+=p,h/=256,e-=8);g=(g<<e)|h;k+=e;for(;k>0;a[c+o]=g&0xff,o+=p,g/=256,k-=8);a[c+o-p]|=q*128;};b.readIEEE754=f;b.writeIEEE754=g;},'index':function(a,b,c,d,e){try{b.BSONPure=d('./bson');b.BSONNative=d('../../ext');}catch(f){}['./binary_parser','./binary','./code','./db_ref','./double','./max_key','./min_key','./objectid','./symbol','./timestamp','./long'].forEach(function(a){var c=d('./'+a);for(var e in c)b[e]=c[e];});b.native=function(){var a={};['./binary_parser','./binary','./code','./db_ref','./double','./max_key','./min_key','./objectid','./symbol','./timestamp','./long','../../ext'].forEach(function(b){var c=d('./'+b);for(var e in c)a[e]=c[e];});return a;};b.pure=function(){var a={};['./binary_parser','./binary','./code','./db_ref','./double','./max_key','./min_key','./objectid','./symbol','./timestamp','./long','././bson'].forEach(function(b){var c=d('./'+b);for(var e in c)a[e]=c[e];});return a;};},'long':function(a,b,c,d,e){function f(a,b){if(!(this instanceof f))return new f(a,b);this._bsontype='Long';this.low_=a|0;this.high_=b|0;};f.prototype.toInt=function(){return this.low_;};f.prototype.toNumber=function(){return this.high_*f.TWO_PWR_32_DBL_+this.getLowBitsUnsigned();};f.prototype.toJSON=function(){return this.toString();};f.prototype.toString=function(a){var b=a||10;if(b<2||36<b)throw Error('radix out of range: '+b);if(this.isZero())return '0';if(this.isNegative())if(this.equals(f.MIN_VALUE)){var c=f.fromNumber(b);var d=this.div(c);var e=d.multiply(c).subtract(this);return d.toString(b)+e.toInt().toString(b);}else return '-'+this.negate().toString(b);var g=f.fromNumber(Math.pow(b,6));var e=this;var h='';while(true){var i=e.div(g);var j=e.subtract(i.multiply(g)).toInt();var k=j.toString(b);e=i;if(e.isZero())return k+h;else{while(k.length<6)k='0'+k;h=''+k+h;}}};f.prototype.getHighBits=function(){return this.high_;};f.prototype.getLowBits=function(){return this.low_;};f.prototype.getLowBitsUnsigned=function(){return(this.low_>=0)?this.low_:f.TWO_PWR_32_DBL_+this.low_;};f.prototype.getNumBitsAbs=function(){if(this.isNegative())if(this.equals(f.MIN_VALUE))return 64;else return this.negate().getNumBitsAbs();else{var a=this.high_!=0?this.high_:this.low_;for(var b=31;b>0;b--)if((a&(1<<b))!=0)break;return this.high_!=0?b+33:b+1;}};f.prototype.isZero=function(){return this.high_==0&&this.low_==0;};f.prototype.isNegative=function(){return this.high_<0;};f.prototype.isOdd=function(){return(this.low_&1)==1;};f.prototype.equals=function(a){return(this.high_==a.high_)&&(this.low_==a.low_);};f.prototype.notEquals=function(a){return(this.high_!=a.high_)||(this.low_!=a.low_);};f.prototype.lessThan=function(a){return this.compare(a)<0;};f.prototype.lessThanOrEqual=function(a){return this.compare(a)<=0;};f.prototype.greaterThan=function(a){return this.compare(a)>0;};f.prototype.greaterThanOrEqual=function(a){return this.compare(a)>=0;};f.prototype.compare=function(a){if(this.equals(a))return 0;var b=this.isNegative();var c=a.isNegative();if(b&&!c)return -1;if(!b&&c)return 1;if(this.subtract(a).isNegative())return -1;else return 1;};f.prototype.negate=function(){if(this.equals(f.MIN_VALUE))return f.MIN_VALUE;else return this.not().add(f.ONE);};f.prototype.add=function(a){var b=this.high_>>>16;var c=this.high_&0xFFFF;var d=this.low_>>>16;var e=this.low_&0xFFFF;var g=a.high_>>>16;var h=a.high_&0xFFFF;var i=a.low_>>>16;var j=a.low_&0xFFFF;var k=0,l=0,m=0,n=0;n+=e+j;m+=n>>>16;n&=0xFFFF;m+=d+i;l+=m>>>16;m&=0xFFFF;l+=c+h;k+=l>>>16;l&=0xFFFF;k+=b+g;k&=0xFFFF;return f.fromBits((m<<16)|n,(k<<16)|l);};f.prototype.subtract=function(a){return this.add(a.negate());};f.prototype.multiply=function(a){if(this.isZero())return f.ZERO;else if(a.isZero())return f.ZERO;if(this.equals(f.MIN_VALUE))return a.isOdd()?f.MIN_VALUE:f.ZERO;else if(a.equals(f.MIN_VALUE))return this.isOdd()?f.MIN_VALUE:f.ZERO;if(this.isNegative())if(a.isNegative())return this.negate().multiply(a.negate());else return this.negate().multiply(a).negate();else if(a.isNegative())return this.multiply(a.negate()).negate();if(this.lessThan(f.TWO_PWR_24_)&&a.lessThan(f.TWO_PWR_24_))return f.fromNumber(this.toNumber()*a.toNumber());var b=this.high_>>>16;var c=this.high_&0xFFFF;var d=this.low_>>>16;var e=this.low_&0xFFFF;var g=a.high_>>>16;var h=a.high_&0xFFFF;var i=a.low_>>>16;var j=a.low_&0xFFFF;var k=0,l=0,m=0,n=0;n+=e*j;m+=n>>>16;n&=0xFFFF;m+=d*j;l+=m>>>16;m&=0xFFFF;m+=e*i;l+=m>>>16;m&=0xFFFF;l+=c*j;k+=l>>>16;l&=0xFFFF;l+=d*i;k+=l>>>16;l&=0xFFFF;l+=e*h;k+=l>>>16;l&=0xFFFF;k+=b*j+c*i+d*h+e*g;k&=0xFFFF;return f.fromBits((m<<16)|n,(k<<16)|l);};f.prototype.div=function(a){if(a.isZero())throw Error('division by zero');else if(this.isZero())return f.ZERO;if(this.equals(f.MIN_VALUE))if(a.equals(f.ONE)||a.equals(f.NEG_ONE))return f.MIN_VALUE;else if(a.equals(f.MIN_VALUE))return f.ONE;else{var b=this.shiftRight(1);var c=b.div(a).shiftLeft(1);if(c.equals(f.ZERO))return a.isNegative()?f.ONE:f.NEG_ONE;else{var d=this.subtract(a.multiply(c));var e=c.add(d.div(a));return e;}}else if(a.equals(f.MIN_VALUE))return f.ZERO;if(this.isNegative())if(a.isNegative())return this.negate().div(a.negate());else return this.negate().div(a).negate();else if(a.isNegative())return this.div(a.negate()).negate();var g=f.ZERO;var d=this;while(d.greaterThanOrEqual(a)){var c=Math.max(1,Math.floor(d.toNumber()/a.toNumber()));var h=Math.ceil(Math.log(c)/Math.LN2);var i=(h<=48)?1:Math.pow(2,h-48);var j=f.fromNumber(c);var k=j.multiply(a);while(k.isNegative()||k.greaterThan(d)){c-=i;j=f.fromNumber(c);k=j.multiply(a);}if(j.isZero())j=f.ONE;g=g.add(j);d=d.subtract(k);}return g;};f.prototype.modulo=function(a){return this.subtract(this.div(a).multiply(a));};f.prototype.not=function(){return f.fromBits(~this.low_,~this.high_);};f.prototype.and=function(a){return f.fromBits(this.low_&a.low_,this.high_&a.high_);};f.prototype.or=function(a){return f.fromBits(this.low_|a.low_,this.high_|a.high_);};f.prototype.xor=function(a){return f.fromBits(this.low_^a.low_,this.high_^a.high_);};f.prototype.shiftLeft=function(a){a&=63;if(a==0)return this;else{var b=this.low_;if(a<32){var c=this.high_;return f.fromBits(b<<a,(c<<a)|(b>>>(32-a)));}else return f.fromBits(0,b<<(a-32));}};f.prototype.shiftRight=function(a){a&=63;if(a==0)return this;else{var b=this.high_;if(a<32){var c=this.low_;return f.fromBits((c>>>a)|(b<<(32-a)),b>>a);}else return f.fromBits(b>>(a-32),b>=0?0:-1);}};f.prototype.shiftRightUnsigned=function(a){a&=63;if(a==0)return this;else{var b=this.high_;if(a<32){var c=this.low_;return f.fromBits((c>>>a)|(b<<(32-a)),b>>>a);}else if(a==32)return f.fromBits(b,0);else return f.fromBits(b>>>(a-32),0);}};f.fromInt=function(a){if(-128<=a&&a<128){var b=f.INT_CACHE_[a];if(b)return b;}var c=new f(a|0,a<0?-1:0);if(-128<=a&&a<128)f.INT_CACHE_[a]=c;return c;};f.fromNumber=function(a){if(isNaN(a)||!isFinite(a))return f.ZERO;else if(a<=-f.TWO_PWR_63_DBL_)return f.MIN_VALUE;else if(a+1>=f.TWO_PWR_63_DBL_)return f.MAX_VALUE;else if(a<0)return f.fromNumber(-a).negate();else return new f((a%f.TWO_PWR_32_DBL_)|0,(a/f.TWO_PWR_32_DBL_)|0);};f.fromBits=function(a,b){return new f(a,b);};f.fromString=function(a,b){if(a.length==0)throw Error('number format error: empty string');var c=b||10;if(c<2||36<c)throw Error('radix out of range: '+c);if(a.charAt(0)=='-')return f.fromString(a.substring(1),c).negate();else if(a.indexOf('-')>=0)throw Error('number format error: interior "-" character: '+a);var d=f.fromNumber(Math.pow(c,8));var e=f.ZERO;for(var g=0;g<a.length;g+=8){var h=Math.min(8,a.length-g);var i=parseInt(a.substring(g,g+h),c);if(h<8){var j=f.fromNumber(Math.pow(c,h));e=e.multiply(j).add(f.fromNumber(i));}else{e=e.multiply(d);e=e.add(f.fromNumber(i));}}return e;};f.INT_CACHE_={};f.TWO_PWR_16_DBL_=1<<16;f.TWO_PWR_24_DBL_=1<<24;f.TWO_PWR_32_DBL_=f.TWO_PWR_16_DBL_*f.TWO_PWR_16_DBL_;f.TWO_PWR_31_DBL_=f.TWO_PWR_32_DBL_/2;f.TWO_PWR_48_DBL_=f.TWO_PWR_32_DBL_*f.TWO_PWR_16_DBL_;f.TWO_PWR_64_DBL_=f.TWO_PWR_32_DBL_*f.TWO_PWR_32_DBL_;f.TWO_PWR_63_DBL_=f.TWO_PWR_64_DBL_/2;f.ZERO=f.fromInt(0);f.ONE=f.fromInt(1);f.NEG_ONE=f.fromInt(-1);f.MAX_VALUE=f.fromBits(0xFFFFFFFF|0,0x7FFFFFFF|0);f.MIN_VALUE=f.fromBits(0,0x80000000|0);f.TWO_PWR_24_=f.fromInt(1<<24);b.Long=f;},'max_key':function(a,b,c,d,e){function f(){if(!(this instanceof f))return new f();this._bsontype='MaxKey';}b.MaxKey=f;},'min_key':function(a,b,c,d,e){function f(){if(!(this instanceof f))return new f();this._bsontype='MinKey';}b.MinKey=f;},'objectid':function(a,b,c,d,e){var f=d('./binary_parser').BinaryParser;var g=parseInt(Math.random()*0xFFFFFF,10);var h=new RegExp("^[0-9a-fA-F]{24}$");var i=function i(a,b){if(!(this instanceof i))return new i(a,b);this._bsontype='ObjectID';var c=null;if(a!=null&&'number'!=typeof a&&(a.length!=12&&a.length!=24))throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");if(a==null||typeof a=='number')this.id=this.generate(a);else if(a!=null&&a.length===12)this.id=a;else if(h.test(a))return i.createFromHexString(a);else throw new Error("Value passed in is not a valid 24 character hex string");if(i.cacheHexString)this.__id=this.toHexString();};var j=i;var k=[];for(var l=0;l<256;l++)k[l]=(l<=15?'0':'')+l.toString(16);i.prototype.toHexString=function(){if(i.cacheHexString&&this.__id)return this.__id;var a='';for(var b=0;b<this.id.length;b++)a+=k[this.id.charCodeAt(b)];if(i.cacheHexString)this.__id=a;return a;};i.prototype.get_inc=function(){return i.index=(i.index+1)%0xFFFFFF;};i.prototype.getInc=function(){return this.get_inc();};i.prototype.generate=function(a){if('number'==typeof a){var b=f.encodeInt(a,32,true,true);var c=f.encodeInt(g,24,false);var d=f.fromShort(typeof process==='undefined'?Math.floor(Math.random()*100000):process.pid);var e=f.encodeInt(this.get_inc(),24,false,true);}else{var h=parseInt(Date.now()/1000,10);var b=f.encodeInt(h,32,true,true);var c=f.encodeInt(g,24,false);var d=f.fromShort(typeof process==='undefined'?Math.floor(Math.random()*100000):process.pid);var e=f.encodeInt(this.get_inc(),24,false,true);}return b+c+d+e;};i.prototype.toString=function(){return this.toHexString();};i.prototype.inspect=i.prototype.toString;i.prototype.toJSON=function(){return this.toHexString();};i.prototype.equals=function m(a){var b=(a instanceof i||a.toHexString)?a.id:i.createFromHexString(a).id;return this.id===b;};i.prototype.getTimestamp=function(){var a=new Date();a.setTime(Math.floor(f.decodeInt(this.id.substring(0,4),32,true,true))*1000);return a;};i.index=parseInt(Math.random()*0xFFFFFF,10);i.createPk=function n(){return new i();};i.createFromTime=function o(a){var b=f.encodeInt(a,32,true,true)+f.encodeInt(0,64,true,true);return new i(b);};i.createFromHexString=function p(a){if(typeof a==='undefined'||a!=null&&a.length!=24)throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");var b=a.length;if(b>12*2)throw new Error('Id cannot be longer than 12 bytes');var c='',d,e;for(var g=0;g<b;g+=2){d=a.substr(g,2);e=parseInt(d,16);c+=f.fromByte(e);}return new i(c,a);};Object.defineProperty(i.prototype,"generationTime",{enumerable:true,get:function(){return Math.floor(f.decodeInt(this.id.substring(0,4),32,true,true));},set:function(a){var a=f.encodeInt(a,32,true,true);this.id=a+this.id.substr(4);this.toHexString();}});b.ObjectID=i;b.ObjectId=i;},'symbol':function(a,b,c,d,e){function f(a){if(!(this instanceof f))return new f(a);this._bsontype='Symbol';this.value=a;}f.prototype.valueOf=function(){return this.value;};f.prototype.toString=function(){return this.value;};f.prototype.inspect=function(){return this.value;};f.prototype.toJSON=function(){return this.value;};b.Symbol=f;},'timestamp':function(a,b,c,d,e){function f(a,b){if(!(this instanceof f))return new f(a,b);this._bsontype='Timestamp';this.low_=a|0;this.high_=b|0;};f.prototype.toInt=function(){return this.low_;};f.prototype.toNumber=function(){return this.high_*f.TWO_PWR_32_DBL_+this.getLowBitsUnsigned();};f.prototype.toJSON=function(){return this.toString();};f.prototype.toString=function(a){var b=a||10;if(b<2||36<b)throw Error('radix out of range: '+b);if(this.isZero())return '0';if(this.isNegative())if(this.equals(f.MIN_VALUE)){var c=f.fromNumber(b);var d=this.div(c);var e=d.multiply(c).subtract(this);return d.toString(b)+e.toInt().toString(b);}else return '-'+this.negate().toString(b);var g=f.fromNumber(Math.pow(b,6));var e=this;var h='';while(true){var i=e.div(g);var j=e.subtract(i.multiply(g)).toInt();var k=j.toString(b);e=i;if(e.isZero())return k+h;else{while(k.length<6)k='0'+k;h=''+k+h;}}};f.prototype.getHighBits=function(){return this.high_;};f.prototype.getLowBits=function(){return this.low_;};f.prototype.getLowBitsUnsigned=function(){return(this.low_>=0)?this.low_:f.TWO_PWR_32_DBL_+this.low_;};f.prototype.getNumBitsAbs=function(){if(this.isNegative())if(this.equals(f.MIN_VALUE))return 64;else return this.negate().getNumBitsAbs();else{var a=this.high_!=0?this.high_:this.low_;for(var b=31;b>0;b--)if((a&(1<<b))!=0)break;return this.high_!=0?b+33:b+1;}};f.prototype.isZero=function(){return this.high_==0&&this.low_==0;};f.prototype.isNegative=function(){return this.high_<0;};f.prototype.isOdd=function(){return(this.low_&1)==1;};f.prototype.equals=function(a){return(this.high_==a.high_)&&(this.low_==a.low_);};f.prototype.notEquals=function(a){return(this.high_!=a.high_)||(this.low_!=a.low_);};f.prototype.lessThan=function(a){return this.compare(a)<0;};f.prototype.lessThanOrEqual=function(a){return this.compare(a)<=0;};f.prototype.greaterThan=function(a){return this.compare(a)>0;};f.prototype.greaterThanOrEqual=function(a){return this.compare(a)>=0;};f.prototype.compare=function(a){if(this.equals(a))return 0;var b=this.isNegative();var c=a.isNegative();if(b&&!c)return -1;if(!b&&c)return 1;if(this.subtract(a).isNegative())return -1;else return 1;};f.prototype.negate=function(){if(this.equals(f.MIN_VALUE))return f.MIN_VALUE;else return this.not().add(f.ONE);};f.prototype.add=function(a){var b=this.high_>>>16;var c=this.high_&0xFFFF;var d=this.low_>>>16;var e=this.low_&0xFFFF;var g=a.high_>>>16;var h=a.high_&0xFFFF;var i=a.low_>>>16;var j=a.low_&0xFFFF;var k=0,l=0,m=0,n=0;n+=e+j;m+=n>>>16;n&=0xFFFF;m+=d+i;l+=m>>>16;m&=0xFFFF;l+=c+h;k+=l>>>16;l&=0xFFFF;k+=b+g;k&=0xFFFF;return f.fromBits((m<<16)|n,(k<<16)|l);};f.prototype.subtract=function(a){return this.add(a.negate());};f.prototype.multiply=function(a){if(this.isZero())return f.ZERO;else if(a.isZero())return f.ZERO;if(this.equals(f.MIN_VALUE))return a.isOdd()?f.MIN_VALUE:f.ZERO;else if(a.equals(f.MIN_VALUE))return this.isOdd()?f.MIN_VALUE:f.ZERO;if(this.isNegative())if(a.isNegative())return this.negate().multiply(a.negate());else return this.negate().multiply(a).negate();else if(a.isNegative())return this.multiply(a.negate()).negate();if(this.lessThan(f.TWO_PWR_24_)&&a.lessThan(f.TWO_PWR_24_))return f.fromNumber(this.toNumber()*a.toNumber());var b=this.high_>>>16;var c=this.high_&0xFFFF;var d=this.low_>>>16;var e=this.low_&0xFFFF;var g=a.high_>>>16;var h=a.high_&0xFFFF;var i=a.low_>>>16;var j=a.low_&0xFFFF;var k=0,l=0,m=0,n=0;n+=e*j;m+=n>>>16;n&=0xFFFF;m+=d*j;l+=m>>>16;m&=0xFFFF;m+=e*i;l+=m>>>16;m&=0xFFFF;l+=c*j;k+=l>>>16;l&=0xFFFF;l+=d*i;k+=l>>>16;l&=0xFFFF;l+=e*h;k+=l>>>16;l&=0xFFFF;k+=b*j+c*i+d*h+e*g;k&=0xFFFF;return f.fromBits((m<<16)|n,(k<<16)|l);};f.prototype.div=function(a){if(a.isZero())throw Error('division by zero');else if(this.isZero())return f.ZERO;if(this.equals(f.MIN_VALUE))if(a.equals(f.ONE)||a.equals(f.NEG_ONE))return f.MIN_VALUE;else if(a.equals(f.MIN_VALUE))return f.ONE;else{var b=this.shiftRight(1);var c=b.div(a).shiftLeft(1);if(c.equals(f.ZERO))return a.isNegative()?f.ONE:f.NEG_ONE;else{var d=this.subtract(a.multiply(c));var e=c.add(d.div(a));return e;}}else if(a.equals(f.MIN_VALUE))return f.ZERO;if(this.isNegative())if(a.isNegative())return this.negate().div(a.negate());else return this.negate().div(a).negate();else if(a.isNegative())return this.div(a.negate()).negate();var g=f.ZERO;var d=this;while(d.greaterThanOrEqual(a)){var c=Math.max(1,Math.floor(d.toNumber()/a.toNumber()));var h=Math.ceil(Math.log(c)/Math.LN2);var i=(h<=48)?1:Math.pow(2,h-48);var j=f.fromNumber(c);var k=j.multiply(a);while(k.isNegative()||k.greaterThan(d)){c-=i;j=f.fromNumber(c);k=j.multiply(a);}if(j.isZero())j=f.ONE;g=g.add(j);d=d.subtract(k);}return g;};f.prototype.modulo=function(a){return this.subtract(this.div(a).multiply(a));};f.prototype.not=function(){return f.fromBits(~this.low_,~this.high_);};f.prototype.and=function(a){return f.fromBits(this.low_&a.low_,this.high_&a.high_);};f.prototype.or=function(a){return f.fromBits(this.low_|a.low_,this.high_|a.high_);};f.prototype.xor=function(a){return f.fromBits(this.low_^a.low_,this.high_^a.high_);};f.prototype.shiftLeft=function(a){a&=63;if(a==0)return this;else{var b=this.low_;if(a<32){var c=this.high_;return f.fromBits(b<<a,(c<<a)|(b>>>(32-a)));}else return f.fromBits(0,b<<(a-32));}};f.prototype.shiftRight=function(a){a&=63;if(a==0)return this;else{var b=this.high_;if(a<32){var c=this.low_;return f.fromBits((c>>>a)|(b<<(32-a)),b>>a);}else return f.fromBits(b>>(a-32),b>=0?0:-1);}};f.prototype.shiftRightUnsigned=function(a){a&=63;if(a==0)return this;else{var b=this.high_;if(a<32){var c=this.low_;return f.fromBits((c>>>a)|(b<<(32-a)),b>>>a);}else if(a==32)return f.fromBits(b,0);else return f.fromBits(b>>>(a-32),0);}};f.fromInt=function(a){if(-128<=a&&a<128){var b=f.INT_CACHE_[a];if(b)return b;}var c=new f(a|0,a<0?-1:0);if(-128<=a&&a<128)f.INT_CACHE_[a]=c;return c;};f.fromNumber=function(a){if(isNaN(a)||!isFinite(a))return f.ZERO;else if(a<=-f.TWO_PWR_63_DBL_)return f.MIN_VALUE;else if(a+1>=f.TWO_PWR_63_DBL_)return f.MAX_VALUE;else if(a<0)return f.fromNumber(-a).negate();else return new f((a%f.TWO_PWR_32_DBL_)|0,(a/f.TWO_PWR_32_DBL_)|0);};f.fromBits=function(a,b){return new f(a,b);};f.fromString=function(a,b){if(a.length==0)throw Error('number format error: empty string');var c=b||10;if(c<2||36<c)throw Error('radix out of range: '+c);if(a.charAt(0)=='-')return f.fromString(a.substring(1),c).negate();else if(a.indexOf('-')>=0)throw Error('number format error: interior "-" character: '+a);var d=f.fromNumber(Math.pow(c,8));var e=f.ZERO;for(var g=0;g<a.length;g+=8){var h=Math.min(8,a.length-g);var i=parseInt(a.substring(g,g+h),c);if(h<8){var j=f.fromNumber(Math.pow(c,h));e=e.multiply(j).add(f.fromNumber(i));}else{e=e.multiply(d);e=e.add(f.fromNumber(i));}}return e;};f.INT_CACHE_={};f.TWO_PWR_16_DBL_=1<<16;f.TWO_PWR_24_DBL_=1<<24;f.TWO_PWR_32_DBL_=f.TWO_PWR_16_DBL_*f.TWO_PWR_16_DBL_;f.TWO_PWR_31_DBL_=f.TWO_PWR_32_DBL_/2;f.TWO_PWR_48_DBL_=f.TWO_PWR_32_DBL_*f.TWO_PWR_16_DBL_;f.TWO_PWR_64_DBL_=f.TWO_PWR_32_DBL_*f.TWO_PWR_32_DBL_;f.TWO_PWR_63_DBL_=f.TWO_PWR_64_DBL_/2;f.ZERO=f.fromInt(0);f.ONE=f.fromInt(1);f.NEG_ONE=f.fromInt(-1);f.MAX_VALUE=f.fromBits(0xFFFFFFFF|0,0x7FFFFFFF|0);f.MIN_VALUE=f.fromBits(0,0x80000000|0);f.TWO_PWR_24_=f.fromInt(1<<24);b.Timestamp=f;}});if(typeof module!='undefined'&&module.exports){module.exports=a;if(!module.parent)a();}if(typeof window!='undefined'&&typeof require=='undefined')window.require=a.require;(function(){var a=this;var b;if(typeof exports!=='undefined')b=window.OnelineTransport||{};else b=a.OnelineTransport=window.OnelineTransport||{};b.WebSockets={};Oneline=window.Oneline||{};b.WebSockets.Ctor=function(a){return window.WebSocket?new window.WebSocket(a):new window.MozWebSocket(a);};b.WebSockets.detect=function(){if(window.WebSocket)return true;if(window.MozWebSocket)return true;return false;};b.XHR={};b.XHR.key=null;b.XHR.Ctor=function(a,c){if(!b.XHR.key)b.XHR.key=Oneline.uuid();return b.XHR.reform(a,c);};b.XHR.opened=false;b.XHR.reform=function(a,c){b.XHR.dataPost="modUrl="+c;var d=new XMLHttpRequest();var c=Oneline.settings.server;d.open("POST",a,true);d.readyState=0;d.close=b.XHR.close;d.sendProto=d.send;d.send=b.XHR.send;d.onmessage=b.XHR.onmessage;d.setRequestHeader('Content-type','application/x-www-form-urlencoded');d.setRequestHeader("X-XHR-Websockets-Oneline",true);return d;};b.XHR.close=function(){};b.XHR.send=function(a){if(!Oneline.socket.loaded){Oneline.socket=b.XHR.reform(Oneline.settings.xhrurl,Oneline.settings.server);Oneline.loaded=false;}if(!b.XHR.opened)b.XHR.opened=true;Oneline.socket.onreadystatechange=function(){Oneline.socket.readyState=this.readyState;if(this.readyState===4&&this.code>=200&&this.code<=299)b.XHR.onmessage({"data":this.responseText});};b.XHR.dataPost+="&data="+a+"&key="+b.XHR.key;Oneline.socket.sendProto(b.XHR.dataPost);};b.XHR.onmessage=function(a){Oneline.socket.onmessage(a);};b.XHR.detect=function(){if(window.XMLHttpRequest)return true;return false;};}).call(this);(function(){var b=this;var c;if(typeof exports!=='undefined')c=window.Oneline||{};else c=b.Oneline=window.Oneline||{};min=Math.min,max=Math.max,pow=Math.pow,sqrt=Math.sqrt,log=Math.log,floor=Math.floor;slice=Array.slice,splice=Array.splice,every=Array.every;websocket={};navigator=window.navigator?window.navigator:[];window.BSON=window.BSON||bson().BSON;BSON.stringify=function(a){return O.uint8ToString(BSON.serialize(a));};BSON.parse=function(a){return BSON.deserialize(O.stringToUint8(a));};c.interop=BSON;c.socket=c.socket||[];c.settings=c.settings||{};c.freq=c.freq=c.freq||1000;c.host=c.host||'localhost';c.port=c.port||9000;c.protoline=c.protoline||[];c.objects=c.objects||[];c.loaded=0;c.setup=function(a){c.settings=a;c.port=a.port||c.port;c.host=a.host||c.host;c.type=a.type==='bind'?'bind':'auto';c.on=a.on||'click';c.target=a.target;a.server=a.module||a.server;if(a.server.match(/ws\:\/\//))c.settings.server=a.server;else c.settings.server=a.server='ws://'+c.host+':'+c.port+'/'+a.server;if(OnelineTransport.WebSockets.detect())c.socket=OnelineTransport.WebSockets.Ctor(c.settings.server);else if(OnelineTransport.XHR.detect()){c.settings.xhrurl="http://"+c.host+":"+(parseInt(c.port)+1).toString();c.socket=OnelineTransport.XHR.Ctor(c.settings.xhrurl,c.settings.server);c.loaded=true;}else console.log("Neither XHR or WebSocket transport is available in this browser");c.interop=typeof a.interop!=='undefined'?a.interop==='json'?JSON:BSON:BSON;c.freq=typeof a.freq!=='undefined'?a.freq:c.freq;c.socket.onopen=function(){c.loaded=1;};c.socket.onmessage=function(a){console.log(O.interop.parse(a.data));};if(typeof a.order!=='undefined')c.order=a.order;else c.order=[];c.target=document.getElementById(c.target);};c.contextOptions={"geolocation":{"limit":{"default":512},"range":{"default":40.00},"bidirectional":{"default":false}}};c.fetchOptional=function(a,b,d){if(typeof d==='undefined')return c.contextOptions[a][b]['default'];return b;};c.agent=function(a){};c.nodes=function(a){};c.stream=function(a){a=a||{};a.pipeline=a.pipeline||O.protoline;return O.pipeline({},a.pipeline,function(a){console.log(a);}).run();};c.value=function(a,b){return{'op':a,'value':b};};c.moment=function(a,b){return{'start':0000,'end':3600};};c.echo=c.echo=function(b,d){c.echo.options=b;if(!d)c.objects.push(a(c.echo(b,1)));return{run:function(a){this.m=a||{};this.m.echo={};this.m.echo.limit=O.echo.options.limit;this.state=1;}};};c.geolocation=c.geo=function(b,d){c.geolocation.options=b;if(!d)c.objects.push(a(c.geo(b,1)));return{run:function(a){this.m=a||{};this.m.geo={};this.state=0;this.m.geo.every=O.geolocation.options.every;this.m.geo.range=O.geolocation.options.range;this.m.geo.limit=O.fetchOptional("geolocation","limit",O.geolocation.options.limit);var b=this;navigator.geolocation.getCurrentPosition(function(a){b.m.geo.lat=a.coords.longitude;b.m.geo.lng=a.coords.latitude;b.m.geo.range=O.geolocation.options.range;b.m.geo.limit=O.geolocation.options.limit;b.state=1;});}};};c.event=function(b,d){c.event.options=b;if(!d)c.objects.push(a(c.event(b,1)));return{run:function(a){this.m=a||{};this.m.event=c.event.options;this.state=1;}};};c.generic=function(b,d){c.generic.options=b;if(!d)c.objects.push(a(c.generic(b,1)));return{run:function(a){this.m=a||{};this.m.generic={};this.m.generic.type=c.generic.options.type;this.m.generic.data=c.generic.options.data;this.state=1;console.log(this);}};};c.time=function(b){c.time.options=b;if(!ready)c.objects.push(a(c.time(b,1)));return{run:function(a){this.m=a||{};this.m.time={};this.m.time.start=c.time.options.moment.start;this.m.time.end=c.time.options.moment.end;this.state=1;}};};c.random=function(b){c.random.options=b;if(!ready)c.objects.push(a(c.random(b,1)));return{run:function(a){this.m=a||{};this.m.random={};this.m.random.amount=c.random.options.amount;this.state=1;}};};c.pipeline=function(a,b,e){if(typeof a!=='undefined'&&typeof a!=='function')O.agent=a;else O.agent={};if(typeof b!=='undefined'&&typeof b!=='function')O.objects=b;O.callback=arguments[arguments.length-1];O.protoline.push(this);O.linetype=c.type;O.provider=O.linetype==='bind'?'Timeout':'Interval';O.runner='Interval';if(c.type==='bind')if(typeof c.target!=='undefined'&&c.target.tagName)c.target['on'+c.on]=function(){return c.pipeline(a,O.objects,O.callback).run();};return{stop:function(){return O.signalStop=1;},run:function(){O.t=window['set'+O.provider](function(){if(c.running)return;if(!c.loaded)return O.connector.connect();if(c.signalStop||O.socket.readyState===2||O.socket.readyState===3)return O.connector.disconnect();O.running=1;O.socket.onmessage=function(a){return O.callback(O.interop.parse(a.data));};var a={},b=0,e={},f=0,g,h=0;for(var h in O.objects){O.objects[parseInt(h)].run(a);O.oot=window['set'+O.runner](function(){if(b!==0&&O.objects[b-1].state!==1)return;if(typeof O.objects[b]!=='object')return;if(O.objects[b].state===1){a=d(a,O.objects[b].m);b++;window['clear'+O.runner](O.oot);}},1);}O.ooot=window['set'+O.runner](function(){if(b===O.objects.length){e.packet=a;g=new Date().getTime();e.packet.order=O.order;e.packet.timestamp=g;e.packet.interop=O.interop;e.uuid=O.uuid();O.socket.send(O.interop.stringify(e));if(typeof O.callback==='function')O.callback(e);O.running=0;window['clear'+O.runner](O.ooot);}},1);},O.freq);}};};c.sound=function(a){c.sound.options=a;return{run:function(a){this.m=a||{};this.m.sound={};this.m.sound.length=c.sound.options.length||60;this.m.sound.field=c.sound.options.field;var b=this;c.speech=new webkitSpeechRecognition();c.speech.onstart=function(){};c.speech.onresult=function(a){console.log(a);b.state=1;};c.speech.lang=c.sound.options.lang||"en-GB";c.speech.start();}};};c.connector={connect:function(){if(O.socket.readyState===0)return;return O.setup(O.settings);},disconnect:function(){O.loaded=0;if(O.socket.readyState===3)return;return O.socket.close();}};c.uuid=function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4);};c.uint8ToString=function(a){var b="[";for(var c in a)b+=c==a.length-1?a[c].toString()+"]":a[c].toString()+", ";return b;};c.stringToUint8=function(a){var b=a.match(/(\d+)/g),c=[];for(var d=0;d!=b.length;d++)c.push(parseInt(b[d]));return c;};function d(a,b,c){for(property in b)a[property]=b[property];for(property in c)a[property]=c[property];return a;};window.O=window.ol=c;}).call(this);function a(c,d){if(c==null||typeof c!=='object')return c;if(d==undefined)d=[];else{var e,f=d.length;for(e=0;e<f;e++)if(c===d[e])return c;}d.push(c);if(typeof c.clone=='function')return c.clone(true);if(Object.prototype.toString.call(c)=='[object Array]'){h=c.slice();var e=h.length;while(e--)h[e]=a(h[e],d);return h;}if(c instanceof Date)return new Date(c.getTime());if(c instanceof RegExp)return new RegExp(c);if(c.nodeType&&typeof c.cloneNode=='function')return c.cloneNode(true);var g=(Object.getPrototypeOf?Object.getPrototypeOf(c):c.__proto__);if(!g)g=c.constructor.prototype;var h=b(g);for(var i in c)h[i]=a(c[i],d);return h;}var b=Object.create;if(typeof b!=='function')b=function(a){function b(){}b.prototype=a;return new b();};
